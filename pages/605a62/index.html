<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker | Edward Blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="帅德华的学习空间,博客,IT,前端,后端,大数据,人工智能,深度学习,机器学习,全栈,算法">
    <meta name="keywords" content="个人技术博客,技术文档,学习,面试">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.6a41b040.css" as="style"><link rel="preload" href="/assets/js/app.b7d292fb.js" as="script"><link rel="preload" href="/assets/js/2.cd5090ec.js" as="script"><link rel="preload" href="/assets/js/179.70c9f38b.js" as="script"><link rel="prefetch" href="/assets/js/10.b3e2b1a6.js"><link rel="prefetch" href="/assets/js/100.3a006d6d.js"><link rel="prefetch" href="/assets/js/101.36d2a221.js"><link rel="prefetch" href="/assets/js/102.0550628a.js"><link rel="prefetch" href="/assets/js/103.ab4aa773.js"><link rel="prefetch" href="/assets/js/104.d8b7b99c.js"><link rel="prefetch" href="/assets/js/105.3a665b3b.js"><link rel="prefetch" href="/assets/js/106.c6593727.js"><link rel="prefetch" href="/assets/js/107.02549fcf.js"><link rel="prefetch" href="/assets/js/108.adbaba7f.js"><link rel="prefetch" href="/assets/js/109.4812d781.js"><link rel="prefetch" href="/assets/js/11.e7ee2da9.js"><link rel="prefetch" href="/assets/js/110.250b0978.js"><link rel="prefetch" href="/assets/js/111.88e70f2e.js"><link rel="prefetch" href="/assets/js/112.c7c96fe1.js"><link rel="prefetch" href="/assets/js/113.a593e3ee.js"><link rel="prefetch" href="/assets/js/114.971d1e7a.js"><link rel="prefetch" href="/assets/js/115.41b9bfac.js"><link rel="prefetch" href="/assets/js/116.4cacdbea.js"><link rel="prefetch" href="/assets/js/117.34966002.js"><link rel="prefetch" href="/assets/js/118.dc47f8ac.js"><link rel="prefetch" href="/assets/js/119.dc26cfd1.js"><link rel="prefetch" href="/assets/js/12.7431d074.js"><link rel="prefetch" href="/assets/js/120.cc4e64b6.js"><link rel="prefetch" href="/assets/js/121.a16ac7cb.js"><link rel="prefetch" href="/assets/js/122.0af4404e.js"><link rel="prefetch" href="/assets/js/123.f060ad4b.js"><link rel="prefetch" href="/assets/js/124.c854fc5a.js"><link rel="prefetch" href="/assets/js/125.c931f8d4.js"><link rel="prefetch" href="/assets/js/126.d6cb2cbb.js"><link rel="prefetch" href="/assets/js/127.d721d65a.js"><link rel="prefetch" href="/assets/js/128.69ce3dab.js"><link rel="prefetch" href="/assets/js/129.73affae7.js"><link rel="prefetch" href="/assets/js/13.a833e9e1.js"><link rel="prefetch" href="/assets/js/130.2306c84a.js"><link rel="prefetch" href="/assets/js/131.eec88d4a.js"><link rel="prefetch" href="/assets/js/132.b90351ff.js"><link rel="prefetch" href="/assets/js/133.9bb09822.js"><link rel="prefetch" href="/assets/js/134.604a5c78.js"><link rel="prefetch" href="/assets/js/135.bff78609.js"><link rel="prefetch" href="/assets/js/136.a69755c9.js"><link rel="prefetch" href="/assets/js/137.69c52aad.js"><link rel="prefetch" href="/assets/js/138.9101d093.js"><link rel="prefetch" href="/assets/js/139.6f329646.js"><link rel="prefetch" href="/assets/js/14.83ea5476.js"><link rel="prefetch" href="/assets/js/140.1e15f890.js"><link rel="prefetch" href="/assets/js/141.6609ef9f.js"><link rel="prefetch" href="/assets/js/142.c1e5fee3.js"><link rel="prefetch" href="/assets/js/143.c539f136.js"><link rel="prefetch" href="/assets/js/144.cda2e584.js"><link rel="prefetch" href="/assets/js/145.98686655.js"><link rel="prefetch" href="/assets/js/146.5df3fbcc.js"><link rel="prefetch" href="/assets/js/147.85df9fee.js"><link rel="prefetch" href="/assets/js/148.8e591dfd.js"><link rel="prefetch" href="/assets/js/149.d18870ed.js"><link rel="prefetch" href="/assets/js/15.dc46caca.js"><link rel="prefetch" href="/assets/js/150.36ab4aa0.js"><link rel="prefetch" href="/assets/js/151.562ccf62.js"><link rel="prefetch" href="/assets/js/152.3ebda2e3.js"><link rel="prefetch" href="/assets/js/153.c7987901.js"><link rel="prefetch" href="/assets/js/154.c6175706.js"><link rel="prefetch" href="/assets/js/155.351d02fc.js"><link rel="prefetch" href="/assets/js/156.64019666.js"><link rel="prefetch" href="/assets/js/157.58c811e2.js"><link rel="prefetch" href="/assets/js/158.6d7b586d.js"><link rel="prefetch" href="/assets/js/159.8b8bcc4c.js"><link rel="prefetch" href="/assets/js/16.1c3696a1.js"><link rel="prefetch" href="/assets/js/160.87c7ed02.js"><link rel="prefetch" href="/assets/js/161.fc42d5ff.js"><link rel="prefetch" href="/assets/js/162.663c7a26.js"><link rel="prefetch" href="/assets/js/163.c8e463c1.js"><link rel="prefetch" href="/assets/js/164.68befca2.js"><link rel="prefetch" href="/assets/js/165.f35c00af.js"><link rel="prefetch" href="/assets/js/166.8f86e68c.js"><link rel="prefetch" href="/assets/js/167.6261e71a.js"><link rel="prefetch" href="/assets/js/168.a2a85a78.js"><link rel="prefetch" href="/assets/js/169.c1c69ae3.js"><link rel="prefetch" href="/assets/js/17.540f0196.js"><link rel="prefetch" href="/assets/js/170.5b58553c.js"><link rel="prefetch" href="/assets/js/171.b95ef18c.js"><link rel="prefetch" href="/assets/js/172.5f34dcd3.js"><link rel="prefetch" href="/assets/js/173.102f4a59.js"><link rel="prefetch" href="/assets/js/174.f1251b96.js"><link rel="prefetch" href="/assets/js/175.2abe9a8d.js"><link rel="prefetch" href="/assets/js/176.283f4bca.js"><link rel="prefetch" href="/assets/js/177.d1b58a33.js"><link rel="prefetch" href="/assets/js/178.3a25015c.js"><link rel="prefetch" href="/assets/js/18.ec189a5f.js"><link rel="prefetch" href="/assets/js/180.603d9b4b.js"><link rel="prefetch" href="/assets/js/181.a97a1249.js"><link rel="prefetch" href="/assets/js/182.90dec55a.js"><link rel="prefetch" href="/assets/js/183.43d1f396.js"><link rel="prefetch" href="/assets/js/184.f1a155bf.js"><link rel="prefetch" href="/assets/js/185.52848888.js"><link rel="prefetch" href="/assets/js/186.8fb8b93b.js"><link rel="prefetch" href="/assets/js/187.e97b43d1.js"><link rel="prefetch" href="/assets/js/188.8deebbb4.js"><link rel="prefetch" href="/assets/js/189.0b6b3d76.js"><link rel="prefetch" href="/assets/js/19.eb6afa27.js"><link rel="prefetch" href="/assets/js/190.7850006c.js"><link rel="prefetch" href="/assets/js/191.0de531bd.js"><link rel="prefetch" href="/assets/js/192.49b7c869.js"><link rel="prefetch" href="/assets/js/193.f5088bd1.js"><link rel="prefetch" href="/assets/js/194.752e2d3e.js"><link rel="prefetch" href="/assets/js/195.af144839.js"><link rel="prefetch" href="/assets/js/196.a3b5ec41.js"><link rel="prefetch" href="/assets/js/197.9bd6416b.js"><link rel="prefetch" href="/assets/js/198.44e56b30.js"><link rel="prefetch" href="/assets/js/199.3b625f72.js"><link rel="prefetch" href="/assets/js/20.93ae83e1.js"><link rel="prefetch" href="/assets/js/200.71da73b6.js"><link rel="prefetch" href="/assets/js/201.3caf5ba8.js"><link rel="prefetch" href="/assets/js/202.b752da29.js"><link rel="prefetch" href="/assets/js/203.485c8a84.js"><link rel="prefetch" href="/assets/js/204.7e9ea94d.js"><link rel="prefetch" href="/assets/js/205.1395e56c.js"><link rel="prefetch" href="/assets/js/206.c1d9b3fa.js"><link rel="prefetch" href="/assets/js/207.179c125b.js"><link rel="prefetch" href="/assets/js/208.f5f4237c.js"><link rel="prefetch" href="/assets/js/209.b120ea2d.js"><link rel="prefetch" href="/assets/js/21.b8ea82d9.js"><link rel="prefetch" href="/assets/js/210.7ac90613.js"><link rel="prefetch" href="/assets/js/211.456ef0c4.js"><link rel="prefetch" href="/assets/js/212.3f7a2e71.js"><link rel="prefetch" href="/assets/js/213.596b3049.js"><link rel="prefetch" href="/assets/js/214.287b50e1.js"><link rel="prefetch" href="/assets/js/215.bc51ef0b.js"><link rel="prefetch" href="/assets/js/216.43d231c3.js"><link rel="prefetch" href="/assets/js/217.97f23b59.js"><link rel="prefetch" href="/assets/js/218.2340a78b.js"><link rel="prefetch" href="/assets/js/219.2307dbcf.js"><link rel="prefetch" href="/assets/js/22.55d14f7b.js"><link rel="prefetch" href="/assets/js/220.35ea6753.js"><link rel="prefetch" href="/assets/js/221.021bea5c.js"><link rel="prefetch" href="/assets/js/222.b5c35cb2.js"><link rel="prefetch" href="/assets/js/223.b47c6bbe.js"><link rel="prefetch" href="/assets/js/224.b3f6df35.js"><link rel="prefetch" href="/assets/js/225.b54fcd56.js"><link rel="prefetch" href="/assets/js/226.9ce83eed.js"><link rel="prefetch" href="/assets/js/227.5230b9cb.js"><link rel="prefetch" href="/assets/js/228.192914ec.js"><link rel="prefetch" href="/assets/js/229.5fd98426.js"><link rel="prefetch" href="/assets/js/23.80a568c2.js"><link rel="prefetch" href="/assets/js/230.85f9c6f4.js"><link rel="prefetch" href="/assets/js/24.8f08b2bb.js"><link rel="prefetch" href="/assets/js/25.fec5eda2.js"><link rel="prefetch" href="/assets/js/26.5d81442e.js"><link rel="prefetch" href="/assets/js/27.26295b5d.js"><link rel="prefetch" href="/assets/js/28.f396a2e8.js"><link rel="prefetch" href="/assets/js/29.900563db.js"><link rel="prefetch" href="/assets/js/3.b6526c66.js"><link rel="prefetch" href="/assets/js/30.b66ed0bc.js"><link rel="prefetch" href="/assets/js/31.b859a995.js"><link rel="prefetch" href="/assets/js/32.8194289e.js"><link rel="prefetch" href="/assets/js/33.f5c2d04e.js"><link rel="prefetch" href="/assets/js/34.2d19107b.js"><link rel="prefetch" href="/assets/js/35.ac561269.js"><link rel="prefetch" href="/assets/js/36.9fa1410f.js"><link rel="prefetch" href="/assets/js/37.10351a5f.js"><link rel="prefetch" href="/assets/js/38.3e5de8fa.js"><link rel="prefetch" href="/assets/js/39.deeecfa2.js"><link rel="prefetch" href="/assets/js/4.56a6dce6.js"><link rel="prefetch" href="/assets/js/40.ce9f37dd.js"><link rel="prefetch" href="/assets/js/41.80e1f687.js"><link rel="prefetch" href="/assets/js/42.9b209d2b.js"><link rel="prefetch" href="/assets/js/43.9bda0522.js"><link rel="prefetch" href="/assets/js/44.e8747563.js"><link rel="prefetch" href="/assets/js/45.f05b3fb7.js"><link rel="prefetch" href="/assets/js/46.ee5de23c.js"><link rel="prefetch" href="/assets/js/47.35c16f52.js"><link rel="prefetch" href="/assets/js/48.5205e21d.js"><link rel="prefetch" href="/assets/js/49.0986d311.js"><link rel="prefetch" href="/assets/js/5.6daa995a.js"><link rel="prefetch" href="/assets/js/50.2fd54d32.js"><link rel="prefetch" href="/assets/js/51.fd45aee9.js"><link rel="prefetch" href="/assets/js/52.b79fde63.js"><link rel="prefetch" href="/assets/js/53.c609e3f7.js"><link rel="prefetch" href="/assets/js/54.48d664ca.js"><link rel="prefetch" href="/assets/js/55.4846c20c.js"><link rel="prefetch" href="/assets/js/56.2d81a481.js"><link rel="prefetch" href="/assets/js/57.0983eed3.js"><link rel="prefetch" href="/assets/js/58.64e25af4.js"><link rel="prefetch" href="/assets/js/59.6df2bb1a.js"><link rel="prefetch" href="/assets/js/6.0e578700.js"><link rel="prefetch" href="/assets/js/60.0256b93a.js"><link rel="prefetch" href="/assets/js/61.0fd2d7d1.js"><link rel="prefetch" href="/assets/js/62.72f8488a.js"><link rel="prefetch" href="/assets/js/63.5d18e154.js"><link rel="prefetch" href="/assets/js/64.fca6f97c.js"><link rel="prefetch" href="/assets/js/65.59b073f6.js"><link rel="prefetch" href="/assets/js/66.766ff8b7.js"><link rel="prefetch" href="/assets/js/67.66a3c046.js"><link rel="prefetch" href="/assets/js/68.5da3942e.js"><link rel="prefetch" href="/assets/js/69.a3bf996b.js"><link rel="prefetch" href="/assets/js/7.81f64b9e.js"><link rel="prefetch" href="/assets/js/70.62d87d58.js"><link rel="prefetch" href="/assets/js/71.4750b647.js"><link rel="prefetch" href="/assets/js/72.333ebb49.js"><link rel="prefetch" href="/assets/js/73.6f4d9e9d.js"><link rel="prefetch" href="/assets/js/74.26b3b7e8.js"><link rel="prefetch" href="/assets/js/75.bf762a44.js"><link rel="prefetch" href="/assets/js/76.90cf59af.js"><link rel="prefetch" href="/assets/js/77.2738d224.js"><link rel="prefetch" href="/assets/js/78.47a05076.js"><link rel="prefetch" href="/assets/js/79.e1034bd9.js"><link rel="prefetch" href="/assets/js/8.2aa77814.js"><link rel="prefetch" href="/assets/js/80.287864c3.js"><link rel="prefetch" href="/assets/js/81.910a8b36.js"><link rel="prefetch" href="/assets/js/82.da3ad6bb.js"><link rel="prefetch" href="/assets/js/83.84d65585.js"><link rel="prefetch" href="/assets/js/84.6e92634f.js"><link rel="prefetch" href="/assets/js/85.8c6d3ddc.js"><link rel="prefetch" href="/assets/js/86.6a0607aa.js"><link rel="prefetch" href="/assets/js/87.a71eea71.js"><link rel="prefetch" href="/assets/js/88.c2e723ac.js"><link rel="prefetch" href="/assets/js/89.563fc718.js"><link rel="prefetch" href="/assets/js/9.c5d68925.js"><link rel="prefetch" href="/assets/js/90.e839c2a7.js"><link rel="prefetch" href="/assets/js/91.4e735fc0.js"><link rel="prefetch" href="/assets/js/92.608975fc.js"><link rel="prefetch" href="/assets/js/93.b5990416.js"><link rel="prefetch" href="/assets/js/94.698fbc87.js"><link rel="prefetch" href="/assets/js/95.db470c04.js"><link rel="prefetch" href="/assets/js/96.096b182e.js"><link rel="prefetch" href="/assets/js/97.cf6e40ac.js"><link rel="prefetch" href="/assets/js/98.3f5ab991.js"><link rel="prefetch" href="/assets/js/99.7c146cfb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6a41b040.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Edward Blog" class="logo"> <span class="site-name can-hide">Edward Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><a href="/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/ai/" class="nav-link">人工智能</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">大数据</a></div><div class="nav-item"><a href="/security/" class="nav-link">网络安全</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/s-dehua/s-dehua.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avter.jpeg"> <div class="blogger-info"><h3>帅德华（Edward）</h3> <span>西电-软件工程-硕士</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><a href="/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/ai/" class="nav-link">人工智能</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">大数据</a></div><div class="nav-item"><a href="/security/" class="nav-link">网络安全</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/s-dehua/s-dehua.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Docker学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e80c8e/" class="sidebar-link">Docker部署hadoop集群(基于centos7)</a></li><li><a href="/pages/605a62/" aria-current="page" class="active sidebar-link">docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/605a62/#docker为什么出现" class="sidebar-link">Docker为什么出现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level5"><a href="/pages/605a62/#历史" class="sidebar-link">历史</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#docker-理念" class="sidebar-link">docker 理念</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#docker能干嘛" class="sidebar-link">Docker能干嘛</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level5"><a href="/pages/605a62/#之前的虚拟机技术" class="sidebar-link">之前的虚拟机技术</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#容器虚拟化技术" class="sidebar-link">容器虚拟化技术</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#开发-运维-devops" class="sidebar-link">开发/运维（DevOps）</a></li><li class="sidebar-sub-header level6"><a href="/pages/605a62/#更快速的应用交付和部署" class="sidebar-link">更快速的应用交付和部署：</a></li><li class="sidebar-sub-header level6"><a href="/pages/605a62/#更便捷的升级和扩缩容" class="sidebar-link">更便捷的升级和扩缩容：</a></li><li class="sidebar-sub-header level6"><a href="/pages/605a62/#更简单的系统运维" class="sidebar-link">更简单的系统运维：</a></li><li class="sidebar-sub-header level6"><a href="/pages/605a62/#更高效的计算资源利用" class="sidebar-link">更高效的计算资源利用：</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#学习途径" class="sidebar-link">学习途径</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#docker的基本组成" class="sidebar-link">Docker的基本组成</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker的架构图" class="sidebar-link">Docker的架构图</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#镜像-image" class="sidebar-link">镜像（image）：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#容器-container" class="sidebar-link">容器（container）：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#仓库-repository" class="sidebar-link">仓库（repository）：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#小结" class="sidebar-link">小结：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#环境说明" class="sidebar-link">环境说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看自己的内核" class="sidebar-link">查看自己的内核：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看版本信息" class="sidebar-link">查看版本信息：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#安装步骤" class="sidebar-link">安装步骤</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1、官网安装参考手册-https-docs-docker-com-engine-install-centos" class="sidebar-link">1、官网安装参考手册：https://docs.docker.com/engine/install/centos/</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2、确定你是centos7及以上版本-我们已经做过了" class="sidebar-link">2、确定你是CentOS7及以上版本，我们已经做过了</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3、yum安装gcc相关环境-需要确保-虚拟机可以上外网" class="sidebar-link">3、yum安装gcc相关环境（需要确保 虚拟机可以上外网 ）</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、卸载旧版本" class="sidebar-link">4 、卸载旧版本</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_5-、安装需要的软件包" class="sidebar-link">5 、安装需要的软件包</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_6-、设置镜像仓库" class="sidebar-link">6 、设置镜像仓库</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_7-、更新yum软件包索引" class="sidebar-link">7 、更新yum软件包索引</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_8-、安装-docker-ce" class="sidebar-link">8 、安装 Docker CE</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_9-、启动-docker" class="sidebar-link">9 、启动 Docker</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_10-、测试命令" class="sidebar-link">10 、测试命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_11-、卸载" class="sidebar-link">11 、卸载</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#阿里云镜像加速" class="sidebar-link">阿里云镜像加速</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、介绍-https-www-aliyun-com-product-acr" class="sidebar-link">1 、介绍：https://www.aliyun.com/product/acr</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、注册一个属于自己的阿里云账户-可复用淘宝账号" class="sidebar-link">2 、注册一个属于自己的阿里云账户(可复用淘宝账号)</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、进入管理控制台设置密码-开通" class="sidebar-link">3 、进入管理控制台设置密码，开通</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、查看镜像加速器自己的" class="sidebar-link">4 、查看镜像加速器自己的</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_5-、配置镜像加速" class="sidebar-link">5 、配置镜像加速</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#测试-helloworld" class="sidebar-link">测试 HelloWorld</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、启动hello-world" class="sidebar-link">1 、启动hello-world</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、run干了什么" class="sidebar-link">2 、run干了什么？</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#底层原理" class="sidebar-link">底层原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker是怎么工作的" class="sidebar-link">Docker是怎么工作的</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#为什么docker比较-vm-快" class="sidebar-link">为什么Docker比较 VM 快</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#帮助命令" class="sidebar-link">帮助命令</a></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#镜像命令" class="sidebar-link">镜像命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker-images" class="sidebar-link">docker images</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker-search" class="sidebar-link">docker search</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker-pull" class="sidebar-link">docker pull</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker-rmi" class="sidebar-link">docker rmi</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#容器命令" class="sidebar-link">容器命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#说明-有镜像才能创建容器-我们这里使用-centos-的镜像来测试-就是虚拟一个-centos" class="sidebar-link">说明：有镜像才能创建容器，我们这里使用 centos 的镜像来测试，就是虚拟一个 centos ！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#新建容器并启动" class="sidebar-link">新建容器并启动</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#列出所有运行的容器" class="sidebar-link">列出所有运行的容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#退出容器" class="sidebar-link">退出容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#启动停止容器" class="sidebar-link">启动停止容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#删除容器" class="sidebar-link">删除容器</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#常用其他命令" class="sidebar-link">常用其他命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#后台启动容器" class="sidebar-link">后台启动容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看日志" class="sidebar-link">查看日志</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看容器中运行的进程信息-支持-ps-命令参数。" class="sidebar-link">查看容器中运行的进程信息，支持 ps 命令参数。</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看容器-镜像的元数据" class="sidebar-link">查看容器/镜像的元数据</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#进入正在运行的容器" class="sidebar-link">进入正在运行的容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#从容器内拷贝文件到主机上" class="sidebar-link">从容器内拷贝文件到主机上</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#小结-2" class="sidebar-link">小结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#常用命令" class="sidebar-link">常用命令</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#作业练习" class="sidebar-link">作业练习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#使用docker-安装-nginx" class="sidebar-link">使用Docker 安装 Nginx</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#使用docker安装-tomcat" class="sidebar-link">使用docker安装 tomcat</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#使用docker-部署-es-kibana" class="sidebar-link">使用docker 部署 es + kibana</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#可视化" class="sidebar-link">可视化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#portainer-先用这个" class="sidebar-link">Portainer（先用这个）</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#rancher-ci-cd再用这个" class="sidebar-link">Rancher（CI/CD再用这个）</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#介绍" class="sidebar-link">介绍：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#访问方式-http-ip-8088" class="sidebar-link">访问方式：http://IP:8088</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#首次登陆需要注册用户-给admin用户设置密码" class="sidebar-link">首次登陆需要注册用户，给admin用户设置密码：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#单机版这里选择local即可-选择完毕-点击connect即可连接到本地docker" class="sidebar-link">单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#登录成功" class="sidebar-link">登录成功！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#我们可以点击可视化界面来玩玩" class="sidebar-link">我们可以点击可视化界面来玩玩！</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#镜像是什么" class="sidebar-link">镜像是什么</a></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#docker镜像加载原理" class="sidebar-link">Docker镜像加载原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#unionfs-联合文件系统" class="sidebar-link">UnionFS （联合文件系统）</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker镜像加载原理-2" class="sidebar-link">Docker镜像加载原理</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#平时我们安装进虚拟机的centos都是好几个g-为什么docker这里才200m" class="sidebar-link">平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#分层理解" class="sidebar-link">分层理解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#分层的镜像" class="sidebar-link">分层的镜像</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#理解" class="sidebar-link">理解：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#特点" class="sidebar-link">特点</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#镜像commit" class="sidebar-link">镜像Commit</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker-commit-从容器创建一个新的镜像。" class="sidebar-link">docker commit 从容器创建一个新的镜像。</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#测试" class="sidebar-link">测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#什么是容器数据卷" class="sidebar-link">什么是容器数据卷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker的理念回顾" class="sidebar-link">docker的理念回顾：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#作用" class="sidebar-link">作用：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#特点-2" class="sidebar-link">特点：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#所以-总结一句话-就是容器的持久化-以及容器间的继承和数据共享" class="sidebar-link">所以：总结一句话： 就是容器的持久化，以及容器间的继承和数据共享！</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#使用数据卷" class="sidebar-link">使用数据卷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#方式一-容器中直接使用命令来添加" class="sidebar-link">方式一：容器中直接使用命令来添加</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#挂载" class="sidebar-link">挂载</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看数据卷是否挂载成功-docker-inspect-容器id" class="sidebar-link">查看数据卷是否挂载成功 docker inspect 容器id</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#测试容器和宿主机之间数据共享-可以发现-在容器中-创建的会在宿主机中看到" class="sidebar-link">测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#测试容器停止退出后-主机修改数据是否会同步" class="sidebar-link">测试容器停止退出后，主机修改数据是否会同步！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#使用-docker-安装-mysql" class="sidebar-link">使用 docker 安装 mysql</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#思考-mysql-数据持久化的问题" class="sidebar-link">思考：mysql 数据持久化的问题！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#通过docker-file-来添加-了解" class="sidebar-link">通过Docker File 来添加（了解）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#数据卷容器" class="sidebar-link">数据卷容器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、先启动一个父容器docker01-然后在datavolumecontainer2新增文件" class="sidebar-link">1 、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#退出不停止-ctrl-p-q" class="sidebar-link">退出不停止：ctrl+P+Q</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、创建docker02-docker03-让他们继承docker01-volumes-from" class="sidebar-link">2 、创建docker02，docker03 让他们继承docker01 --volumes-from</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、回到docker01发现可以看到-02-和-03-添加的共享文件" class="sidebar-link">3 、回到docker01发现可以看到 02 和 03 添加的共享文件</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、删除docker01-docker02-修改后docker03还能不能访问" class="sidebar-link">4 、删除docker01，docker02 修改后docker03还能不能访问</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_5-、删除docker02-docker03还能不能访问" class="sidebar-link">5 、删除docker02 ，docker03还能不能访问</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_6-、新建docker04继承docker03-然后再删除docker03-看下是否可以访问" class="sidebar-link">6 、新建docker04继承docker03，然后再删除docker03，看下是否可以访问！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#得出结论" class="sidebar-link">得出结论：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#什么是dockerfile" class="sidebar-link">什么是DockerFile</a></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#dockerfile构建过程" class="sidebar-link">DockerFile构建过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#基础知识" class="sidebar-link">基础知识：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#流程" class="sidebar-link">流程：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#说明" class="sidebar-link">说明：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#dockerfile指令" class="sidebar-link">DockerFile指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#关键字" class="sidebar-link">关键字：</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#实战测试" class="sidebar-link">实战测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#自定义一个-centos" class="sidebar-link">自定义一个 centos</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、编写dockerfile" class="sidebar-link">1 、编写DockerFile</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看下官方默认的centos的情况" class="sidebar-link">查看下官方默认的CentOS的情况：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#目的-使我们自己的镜像具备如下-登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持" class="sidebar-link">目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#准备编写dockerflie文件" class="sidebar-link">准备编写DockerFlie文件</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、构建" class="sidebar-link">2 、构建</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、运行" class="sidebar-link">3 、运行</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#可以看到-我们自己的新镜像已经支持-vim-ifconfig的命令-扩展ok" class="sidebar-link">可以看到，我们自己的新镜像已经支持 vim/ifconfig的命令，扩展OK！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、列出镜像地的变更历史" class="sidebar-link">4 、列出镜像地的变更历史</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#cmd-和-entrypoint-的区别" class="sidebar-link">CMD 和 ENTRYPOINT 的区别</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#cmd命令" class="sidebar-link">CMD命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#entrypoint命令" class="sidebar-link">ENTRYPOINT命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#自定义镜像-tomcat" class="sidebar-link">自定义镜像 tomcat</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#当前文件状态" class="sidebar-link">当前文件状态</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_5-、构建镜像" class="sidebar-link">5 、构建镜像</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_6-、运行启动-run" class="sidebar-link">6 、运行启动 run</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_7-、验证测试访问-curl-localhost-9090" class="sidebar-link">7 、验证测试访问！ curl localhost:9090</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_8-、结合前面学习的容器卷将测试的web服务test发布" class="sidebar-link">8 、结合前面学习的容器卷将测试的web服务test发布</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#web-xml" class="sidebar-link">web.xml</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#a-jsp" class="sidebar-link">a.jsp</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_9-、测试" class="sidebar-link">9 、测试</a></li><li class="sidebar-sub-header level4"><a href="/pages/605a62/#查看日志-2" class="sidebar-link"># 查看日志</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#发布镜像" class="sidebar-link">发布镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#dockerhub" class="sidebar-link">DockerHub</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#注册dockerhub-https-hub-docker-com-signup-需要有一个账号" class="sidebar-link">注册dockerhub https://hub.docker.com/signup，需要有一个账号</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#阿里云镜像服务" class="sidebar-link">阿里云镜像服务</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、创建命名空间" class="sidebar-link">3 、创建命名空间</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、创建镜像仓库" class="sidebar-link">4 、创建镜像仓库</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_5-、点击进入这个镜像仓库-可以看到所有的信息" class="sidebar-link">5 、点击进入这个镜像仓库，可以看到所有的信息</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_6-、测试推送发布" class="sidebar-link">6 、测试推送发布</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_7-、在阿里云镜像仓库查看效果" class="sidebar-link">7 、在阿里云镜像仓库查看效果！</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#理解docker0" class="sidebar-link">理解Docker0</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#准备工作-清空所有的容器-清空所有的镜像" class="sidebar-link">准备工作：清空所有的容器，清空所有的镜像</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#docker的网络也是十分重要的一个点-希望大家可以认真理解" class="sidebar-link">Docker的网络也是十分重要的一个点，希望大家可以认真理解！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#我们先来做个测试" class="sidebar-link">我们先来做个测试</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看本地ip-ip-addr" class="sidebar-link">查看本地ip ip addr</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#这里我们分析可得-有三个网络" class="sidebar-link">这里我们分析可得，有三个网络：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、每一个安装了docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡-使用了veth-pair技术" class="sidebar-link">1 、每一个安装了Docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡，使用了veth-pair技术！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、每启动一个容器-linux主机就会多了一个虚拟网卡。" class="sidebar-link">2 、每启动一个容器，linux主机就会多了一个虚拟网卡。</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通" class="sidebar-link">3 、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、我们来画一个网络模型图" class="sidebar-link">4 、我们来画一个网络模型图</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#小结-3" class="sidebar-link">小结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#link" class="sidebar-link">--Link</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#思考-这个原理是什么呢-我们进入tomcat03中查看下host配置文件" class="sidebar-link">思考，这个原理是什么呢？我们进入tomcat03中查看下host配置文件</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#link早都过时了-我们不推荐使用-我们可以使用自定义网络的方式" class="sidebar-link">--link早都过时了，我们不推荐使用！我们可以使用自定义网络的方式</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#自定义网络" class="sidebar-link">自定义网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#基本命令查看" class="sidebar-link">基本命令查看</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#命令如下" class="sidebar-link">命令如下：</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看所有网络" class="sidebar-link">查看所有网络</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#网络模式" class="sidebar-link">网络模式</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#查看一个具体的网络的详细信息" class="sidebar-link">查看一个具体的网络的详细信息</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#自定义网卡" class="sidebar-link">自定义网卡</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、删除原来的所有容器" class="sidebar-link">1 、删除原来的所有容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、接下来我们来创建容器-但是我们知道默认创建的容器都是docker0网卡的" class="sidebar-link">2 、接下来我们来创建容器，但是我们知道默认创建的容器都是docker0网卡的</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、我们可以让容器创建的时候使用自定义网络" class="sidebar-link">3 、我们可以让容器创建的时候使用自定义网络</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#聊了这么多-我们现在应该可以深刻理解docker的网络了" class="sidebar-link">聊了这么多，我们现在应该可以深刻理解docker的网络了！</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#网络连通" class="sidebar-link">网络连通</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#结论-如果要跨网络操作别人-就需要使用-docker-network-connect-options-network-container-连接" class="sidebar-link">结论：如果要跨网络操作别人，就需要使用 docker network connect [OPTIONS] NETWORK CONTAINER 连接</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#实战-部署一个redis集群" class="sidebar-link">实战：部署一个Redis集群</a></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#创建项目" class="sidebar-link">创建项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、启动测试下-端口修改下-避免-8080-冲突-本地访问没问题就可以" class="sidebar-link">3 、启动测试下，端口修改下，避免 8080 冲突！本地访问没问题就可以！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_4-、打jar包" class="sidebar-link">4 、打jar包</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#有了-jar-包-我们就可以作镜像了-记得测试一下jar包可以使用吗" class="sidebar-link">有了 jar 包，我们就可以作镜像了！ 记得测试一下jar包可以使用吗！</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#打包镜像" class="sidebar-link">打包镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level5"><a href="/pages/605a62/#_1-、在项目下编写-dockerfile-文件-将打包好的jar包拷贝到dockerfile同级目录" class="sidebar-link">1 、在项目下编写 Dockerfile 文件，将打包好的jar包拷贝到Dockerfile同级目录</a></li><li class="sidebar-sub-header level5"><a href="/pages/605a62/#_2-、将dockerfile-和-项目的-jar-包上传到linux服务器上-构建运行" class="sidebar-link">2 、将Dockerfile 和 项目的 jar 包上传到linux服务器上，构建运行</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/605a62/#idea安装插件" class="sidebar-link">IDEA安装插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level6"><a href="/pages/605a62/#了解即可-以后ci-cd-就完全没必要这样做" class="sidebar-link">了解即可！以后CI/CD，就完全没必要这样做！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_1-、idea安装插件" class="sidebar-link">1 、IDEA安装插件</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_2-、配置docker连接集成" class="sidebar-link">2 、配置docker连接集成</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#_3-、集成了docker插件就可以在idea中操作docker内部的容器和镜像了-但是很鸡肋这个功能-对于我们开发人员来说" class="sidebar-link">3 、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说！</a></li><li class="sidebar-sub-header level3"><a href="/pages/605a62/#之后学习的ci-cd才是真正在企业中的王道" class="sidebar-link">之后学习的CI/CD才是真正在企业中的王道！</a></li></ul></li></ul></li><li><a href="/pages/3108f8/" class="sidebar-link">advanced</a></li><li><a href="/pages/8d5ab4/" class="sidebar-link">安装docker</a></li><li><a href="/pages/54ba5f/" class="sidebar-link">docker 私有仓库</a></li><li><a href="/pages/bc4906/" class="sidebar-link">dockerfile</a></li><li><a href="/pages/8d057a/" class="sidebar-link">docker-compose</a></li><li><a href="/pages/b25f9a/" class="sidebar-link">docker应用部署</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/backend/#后端" data-v-06225672>后端</a></li><li data-v-06225672><a href="/backend/#Docker学习" data-v-06225672>Docker学习</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/s-dehua" target="_blank" title="作者" class="beLink" data-v-06225672>帅德华</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-11-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">docker<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="docker概述"><a href="#docker概述" class="header-anchor">#</a> Docker概述</h1> <h2 id="docker为什么出现"><a href="#docker为什么出现" class="header-anchor">#</a> Docker为什么出现</h2> <blockquote><p>一款产品从开发到上线，从操作系统，到运行环境，再到应用配置。作为开发+运维之间的协作我们需要
关心很多东西，这也是很多互联网公司都不得不面对的问题，特别是各种版本的迭代之后，不同版本环
境的兼容，对运维人员是极大的考验！
环境配置如此麻烦，换一台机器，就要重来一次，费力费时。很多人想到，能不能从根本上解决问题，
软件可以带环境安装？也就是说，安装的时候，把原始环境一模一样地复制过来。解决开发人员说的“ 在
我的机器上可正常工作”的问题。
之前在服务器配置一个应用的运行环境，要安装各种软件，就拿一个基本的工程项目的环境来说吧，
Java/Tomcat/MySQL/JDBC驱动包等。安装和配置这些东西有多麻烦就不说了，它还不能跨平台。假如
我们是在 Windows 上安装的这些环境，到了 Linux 又得重新装。况且就算不跨操作系统，换另一台同
样操作系统的服务器，要移植应用也是非常麻烦的。
传统上认为，软件编码开发/测试结束后，所产出的成果即是程序或是能够编译执行的二进制字节码文件
等（Java为例）。而为了让这些程序可以顺利执行，开发团队也得准备完整的部署文件，让维运团队得
以部署应用程式，开发需要清楚的告诉运维部署团队，用的全部配置文件+所有软件环境。不过，即便如
此，仍然常常发生部署失败的状况。
Docker之所以发展如此迅速，也是因为它对此给出了一个标准化的解决方案。
Docker镜像的设计，使得Docker得以打破过去「程序即应用」的观念。通过Docker镜像 ( images ) 将
应用程序所需要的系统环境，由下而上打包，达到应用程序跨平台间的无缝接轨运作。</p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719141143.png" alt="img"></p> <blockquote><p>Docker的思想来自于集装箱，集装箱解决了什么问题？在一艘大船上，可以把货物规整的摆放起来。并
且各种各样的货物被集装箱标准化了，集装箱和集装箱之间不会互相影响。那么我就不需要专门运送水
果的船和专门运送化学品的船了。只要这些货物在集装箱里封装的好好的，那我就可以用一艘大船把他
们都运走。</p></blockquote> <p>docker就是类似的理念。</p> <h5 id="历史"><a href="#历史" class="header-anchor">#</a> 历史</h5> <blockquote><p>2010年，几个搞IT的年轻人，在美国旧金山成立了一家名叫“dotCloud”的公司。
这家公司主要提供基于PaaS的云计算技术服务。具体来说，是和LXC有关的容器技术。
后来，dotCloud公司将自己的容器技术进行了简化和标准化，并命名为——Docker。
Docker技术诞生之后，并没有引起行业的关注。而dotCloud公司，作为一家小型创业企业，在激烈的竞
争之下，也步履维艰。
正当他们快要坚持不下去的时候，脑子里蹦出了“开源”的想法。
什么是“开源”？开源，就是开放源代码。也就是将原来内部保密的程序源代码开放给所有人，然后让大
家一起参与进来，贡献代码和意见。
有的软件是一开始就开源的。也有的软件，是混不下去，创造者又不想放弃，所以选择开源。自己养不
活，就吃“百家饭”嘛。
2013年3月，dotCloud公司的创始人之一，Docker之父，28岁的Solomon Hykes正式决定，将
Docker项目开源。
不开则已，一开惊人。
越来越多的IT工程师发现了Docker的优点，然后蜂拥而至，加入Docker开源社区。
Docker的人气迅速攀升，速度之快，令人瞠目结舌。
开源当月，Docker 0.1 版本发布。此后的每一个月，Docker都会发布一个版本。到2014年6月9日，
Docker 1.0 版本正式发布。
此时的Docker，已经成为行业里人气最火爆的开源技术，没有之一。甚至像Google、微软、Amazon、
VMware这样的巨头，都对它青睐有加，表示将全力支持。
Docker和容器技术为什么会这么火爆？说白了，就是因为它“轻”。
在容器技术之前，业界的网红是虚拟机。虚拟机技术的代表，是VMWare和OpenStack。
相信很多人都用过虚拟机。虚拟机，就是在你的操作系统里面，装一个软件，然后通过这个软件，再模
拟一台甚至多台“子电脑”出来。
在“子电脑”里，你可以和正常电脑一样运行程序，例如开QQ。如果你愿意，你可以变出好几个“子电
脑”，里面都开上QQ。“子电脑”和“子电脑”之间，是相互隔离的，互不影响。
虚拟机属于虚拟化技术。而Docker这样的容器技术，也是虚拟化技术，属于轻量级的虚拟化。
虚拟机虽然可以隔离出很多“子电脑”，但占用空间更大，启动更慢，虚拟机软件可能还要花钱（例如
VMWare）。
而容器技术恰好没有这些缺点。它不需要虚拟出整个操作系统，只需要虚拟一个小规模的环境（类似“沙 箱”）。
它启动时间很快，几秒钟就能完成。而且，它对资源的利用率很高（一台主机可以同时运行几千个
Docker容器）。此外，它占的空间很小，虚拟机一般要几GB到几十GB的空间，而容器只需要MB级甚至
KB级。
正因为如此，容器技术受到了热烈的欢迎和追捧，发展迅速。</p></blockquote> <h5 id="docker-理念"><a href="#docker-理念" class="header-anchor">#</a> docker 理念</h5> <blockquote><p>Docker是基于Go语言实现的云开源项目。
Docker的主要目标是“Build，Ship and Run Any App , Anywhere”，也就是通过对应用组件的封装、分
发、部署、运行等生命周期的管理，使用户的APP（可以是一个WEB应用或数据库应用等等）及其运行
环境能够做到“一次封装，到处运行”。
Linux 容器技术的出现就解决了这样一个问题，而 Docker 就是在它的基础上发展过来的。将应用运行在
Docker 容器上面，而 Docker 容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。只需
要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作。</p></blockquote> <h2 id="docker能干嘛"><a href="#docker能干嘛" class="header-anchor">#</a> Docker能干嘛</h2> <h5 id="之前的虚拟机技术"><a href="#之前的虚拟机技术" class="header-anchor">#</a> 之前的虚拟机技术</h5> <blockquote><p>虚拟机（virtual machine）就是带环境安装的一种解决方案。
它可以在一种操作系统里面运行另一种操作系统，比如在Windows 系统里面运行Linux 系统。应用程序
对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文
件，不需要了就删掉，对其他部分毫无影响。这类虚拟机完美的运行了另一套系统，能够使应用程序，
操作系统和硬件三者之间的逻辑不变。</p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719141816.png" alt="img"></p> <ul><li>虚拟机的缺点：
<ul><li>1 、资源占用多</li> <li>2 、冗余步骤多</li> <li>3 、启动慢</li></ul></li></ul> <h5 id="容器虚拟化技术"><a href="#容器虚拟化技术" class="header-anchor">#</a> 容器虚拟化技术</h5> <blockquote><p>由于前面虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩
写为 LXC）。
Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的
所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作
所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。<br> <img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719141955.png" alt="img">
比较了 Docker 和传统虚拟化方式的不同之处：</p> <ul><li>传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用
进程；</li> <li>而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。
因此容器要比传统虚拟机更为轻便。</li> <li>每个容器之间互相隔离，每个容器有自己的文件系统 ，容器之间进程不会相互影响，能区分计算资
源。</li></ul></blockquote> <h5 id="开发-运维-devops"><a href="#开发-运维-devops" class="header-anchor">#</a> 开发/运维（DevOps）</h5> <h6 id="更快速的应用交付和部署"><a href="#更快速的应用交付和部署" class="header-anchor">#</a> 更快速的应用交付和部署：</h6> <blockquote><p>传统的应用开发完成后，需要提供一堆安装程序和配置说明文档，安装部署后需根据配置文档进行繁杂
的配置才能正常运行。Docker化之后只需要交付少量容器镜像文件，在正式生产环境加载镜像并运行即
可，应用安装配置在镜像里已经内置好，大大节省部署配置和测试验证时间。</p></blockquote> <h6 id="更便捷的升级和扩缩容"><a href="#更便捷的升级和扩缩容" class="header-anchor">#</a> 更便捷的升级和扩缩容：</h6> <blockquote><p>随着微服务架构和Docker的发展，大量的应用会通过微服务方式架构，应用的开发构建将变成搭乐高积
木一样，每个Docker容器将变成一块“积木”，应用的升级将变得非常容易。当现有的容器不足以支撑业
务处理时，可通过镜像运行新的容器进行快速扩容，使应用系统的扩容从原先的天级变成分钟级甚至秒
级。</p></blockquote> <h6 id="更简单的系统运维"><a href="#更简单的系统运维" class="header-anchor">#</a> 更简单的系统运维：</h6> <blockquote><p>应用容器化运行后，生产环境运行的应用可与开发、测试环境的应用高度一致，容器会将应用程序相关
的环境和状态完全封装起来，不会因为底层基础架构和操作系统的不一致性给应用带来影响，产生新的
BUG。当出现程序异常时，也可以通过测试环境的相同容器进行快速定位和修复。</p></blockquote> <h6 id="更高效的计算资源利用"><a href="#更高效的计算资源利用" class="header-anchor">#</a> 更高效的计算资源利用：</h6> <blockquote><p>Docker是内核级虚拟化，其不像传统的虚拟化技术一样需要额外的Hypervisor [管理程序] 支持，所以在
一台物理机上可以运行很多个容器实例，可大大提升物理服务器的CPU和内存的利用率。</p></blockquote> <h5 id="学习途径"><a href="#学习途径" class="header-anchor">#</a> 学习途径</h5> <p>Docker官网：http://www.docker.com</p> <p>Docker中文网站：https://www.docker-cn.com</p> <p>Docker Hub官网：https://hub.docker.com （仓库）</p> <p>还是我那句话，只要学不死，就往死里学！</p> <h1 id="docker安装"><a href="#docker安装" class="header-anchor">#</a> Docker安装</h1> <h2 id="docker的基本组成"><a href="#docker的基本组成" class="header-anchor">#</a> Docker的基本组成</h2> <h3 id="docker的架构图"><a href="#docker的架构图" class="header-anchor">#</a> Docker的架构图</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719142742.png" alt="img"></p> <h3 id="镜像-image"><a href="#镜像-image" class="header-anchor">#</a> 镜像（image）：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>Docker 镜像（Image）就是一个只读的模板。镜像可以用来创建 Docker 容器，一个镜像可以创建很 多容器。 就好似 Java 中的 类和对象，类就是镜像，容器就是对象！
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="容器-container"><a href="#容器-container" class="header-anchor">#</a> 容器（container）：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>Docker 利用容器（Container）独立运行的一个或一组应用。容器是用镜像创建的运行实例。 
它可以被启动、开始、停止、删除。每个容器都是相互隔离的，保证安全的平台。 
可以把容器看做是一个简易版的 Linux 环境（包括root用户权限、进程空间、用户空间和网络空间等） 和运行在其中的应用程序。。 
容器的定义和镜像几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写 的。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="仓库-repository"><a href="#仓库-repository" class="header-anchor">#</a> 仓库（repository）：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>仓库（Repository）是集中存放镜像文件的场所。 
仓库(Repository)和仓库注册服务器（Registry）是有区别的。仓库注册服务器上往往存放着多个仓 库，每个仓库中又包含了多个镜像，每个镜像有不同的标签（tag）。 
仓库分为公开仓库（Public）和私有仓库（Private）两种形式。 
最大的公开仓库是 Docker Hub(https://hub.docker.com/)，存放了数量庞大的镜像供用户下载。 
国内的公开仓库包括阿里云 、网易云 等 12345678
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结：</h3> <ul><li>Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个
可交付的运行环境，这个打包好的运行环境就似乎 image镜像文件。只有通过这个镜像文件才能生
成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。
同一个 image 文件，可以生成多个同时运行的容器实例。</li> <li>image 文件生成的容器实例，本身也是一个文件，称为镜像文件。</li> <li>一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，
也就是我们的容器</li> <li>至于仓库，就是放了一堆镜像的地方，我们可以把镜像发布到仓库中，需要的时候从仓库中拉下来
就可以了。</li></ul> <h2 id="环境说明"><a href="#环境说明" class="header-anchor">#</a> 环境说明</h2> <blockquote><p>我们使用的是 CentOS 7 (64-bit)
目前，CentOS 仅发行版本中的内核支持 Docker。
Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。</p></blockquote> <h3 id="查看自己的内核"><a href="#查看自己的内核" class="header-anchor">#</a> 查看自己的内核：</h3> <p>uname -r 命令用于打印当前系统相关信息（内核版本号、硬件架构、主机名称和操作系统类型</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@kuangshen ~]# uname -r 
3.10.0-1062.12.1.el7.x86_64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="查看版本信息"><a href="#查看版本信息" class="header-anchor">#</a> 查看版本信息：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat /etc/os-release
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>[root@kuangshen ~]# cat /etc/os-release 
NAME=&quot;CentOS Linux&quot; 
VERSION=&quot;7 (Core)&quot; 
ID=&quot;centos&quot; 
ID_LIKE=&quot;rhel fedora&quot; 
VERSION_ID=&quot;7&quot; 
PRETTY_NAME=&quot;CentOS Linux 7 (Core)&quot; 
ANSI_COLOR=&quot;0;31&quot; 
CPE_NAME=&quot;cpe:/o:centos:centos:7&quot; 
HOME_URL=&quot;https://www.centos.org/&quot; 
BUG_REPORT_URL=&quot;https://bugs.centos.org/&quot; 
CENTOS_MANTISBT_PROJECT=&quot;CentOS-7&quot; 
CENTOS_MANTISBT_PROJECT_VERSION=&quot;7&quot; 
REDHAT_SUPPORT_PRODUCT=&quot;centos&quot; 
REDHAT_SUPPORT_PRODUCT_VERSION=&quot;7&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="安装步骤"><a href="#安装步骤" class="header-anchor">#</a> 安装步骤</h2> <h3 id="_1、官网安装参考手册-https-docs-docker-com-engine-install-centos"><a href="#_1、官网安装参考手册-https-docs-docker-com-engine-install-centos" class="header-anchor">#</a> 1、官网安装参考手册：https://docs.docker.com/engine/install/centos/ <br></h3> <h3 id="_2、确定你是centos7及以上版本-我们已经做过了"><a href="#_2、确定你是centos7及以上版本-我们已经做过了" class="header-anchor">#</a> 2、确定你是CentOS7及以上版本，我们已经做过了<br></h3> <h3 id="_3、yum安装gcc相关环境-需要确保-虚拟机可以上外网"><a href="#_3、yum安装gcc相关环境-需要确保-虚拟机可以上外网" class="header-anchor">#</a> 3、yum安装gcc相关环境（需要确保 虚拟机可以上外网 ）<br></h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum -y install gcc 
yum -y install gcc-c++
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4-、卸载旧版本"><a href="#_4-、卸载旧版本" class="header-anchor">#</a> 4 、卸载旧版本</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum remove docker \
                docker-client \ 
                docker-client-latest \ 
                docker-common \ 
                docker-latest \ 
                docker-latest-logrotate \ 
                docker-logrotate \ 
                docker-engine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_5-、安装需要的软件包"><a href="#_5-、安装需要的软件包" class="header-anchor">#</a> 5 、安装需要的软件包</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install -y yum-utils
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_6-、设置镜像仓库"><a href="#_6-、设置镜像仓库" class="header-anchor">#</a> 6 、设置镜像仓库</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code># 错误 
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo 
## 报错 
[Errno 14] curl#35 - TCP connection reset by peer 
[Errno 12] curl#35 - Timeout 

# 正确推荐使用国内的 
yum-config-manager --add-repo http://mirrors.aliyun.com/docker- ce/linux/centos/docker-ce.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_7-、更新yum软件包索引"><a href="#_7-、更新yum软件包索引" class="header-anchor">#</a> 7 、更新yum软件包索引</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum makecache fast
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_8-、安装-docker-ce"><a href="#_8-、安装-docker-ce" class="header-anchor">#</a> 8 、安装 Docker CE</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install docker-ce docker-ce-cli containerd.io
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-、启动-docker"><a href="#_9-、启动-docker" class="header-anchor">#</a> 9 、启动 Docker</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl start docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_10-、测试命令"><a href="#_10-、测试命令" class="header-anchor">#</a> 10 、测试命令</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker version 
docker run hello-world 
docker images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719144333.png" alt="img"></p> <h3 id="_11-、卸载"><a href="#_11-、卸载" class="header-anchor">#</a> 11 、卸载</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl stop docker 
yum -y remove docker-ce docker-ce-cli containerd.io 
rm -rf /var/lib/docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="阿里云镜像加速"><a href="#阿里云镜像加速" class="header-anchor">#</a> 阿里云镜像加速</h2> <h3 id="_1-、介绍-https-www-aliyun-com-product-acr"><a href="#_1-、介绍-https-www-aliyun-com-product-acr" class="header-anchor">#</a> 1 、介绍：https://www.aliyun.com/product/acr</h3> <h3 id="_2-、注册一个属于自己的阿里云账户-可复用淘宝账号"><a href="#_2-、注册一个属于自己的阿里云账户-可复用淘宝账号" class="header-anchor">#</a> 2 、注册一个属于自己的阿里云账户(可复用淘宝账号)</h3> <h3 id="_3-、进入管理控制台设置密码-开通"><a href="#_3-、进入管理控制台设置密码-开通" class="header-anchor">#</a> 3 、进入管理控制台设置密码，开通</h3> <h3 id="_4-、查看镜像加速器自己的"><a href="#_4-、查看镜像加速器自己的" class="header-anchor">#</a> 4 、查看镜像加速器自己的</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719144512.png" alt="img"></p> <h3 id="_5-、配置镜像加速"><a href="#_5-、配置镜像加速" class="header-anchor">#</a> 5 、配置镜像加速</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo mkdir -p /etc/docker 
sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF' 
{ 
    &quot;registry-mirrors&quot;: [&quot;https://qiyb9988.mirror.aliyuncs.com&quot;] 
}
EOF 

sudo systemctl daemon-reload 
sudo systemctl restart docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="测试-helloworld"><a href="#测试-helloworld" class="header-anchor">#</a> 测试 HelloWorld</h3> <h3 id="_1-、启动hello-world"><a href="#_1-、启动hello-world" class="header-anchor">#</a> 1 、启动hello-world</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-、run干了什么"><a href="#_2-、run干了什么" class="header-anchor">#</a> 2 、run干了什么？</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719144738.png" alt="img"></p> <h2 id="底层原理"><a href="#底层原理" class="header-anchor">#</a> 底层原理</h2> <h3 id="docker是怎么工作的"><a href="#docker是怎么工作的" class="header-anchor">#</a> Docker是怎么工作的</h3> <blockquote><p>Docker是一个Client-Server结构的系统，Docker守护进程运行在主机上， 然后通过Socket连接从客户
端访问，守护进程从客户端接受命令并管理运行在主机上的容器。 容器，是一个运行时环境，就是我们
前面说到的集装箱。</p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719144822.png" alt="img"></p> <h3 id="为什么docker比较-vm-快"><a href="#为什么docker比较-vm-快" class="header-anchor">#</a> 为什么Docker比较 VM 快</h3> <p>1、docker有着比虚拟机更少的抽象层。由亍docker不需要Hypervisor实现硬件资源虚拟化,运行在
docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在
效率上有明显优势。</p> <p>2、docker利用的是宿主机的内核,而不需要Guest OS。因此,当新建一个容器时,docker不需要和虚拟机
一样重新加载一个操作系统内核。仍而避免引寻、加载操作系统内核返个比较费时费资源的过程,当新建
一个虚拟机时,虚拟机软件需要加载Guest OS,返个新建过程是分钟级别的。而docker由于直接利用宿主
机的操作系统,则省略了返个过程,因此新建一个docker容器只需要几秒钟。
<img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719145020.png" alt="img"></p> <h1 id="docker常用命令"><a href="#docker常用命令" class="header-anchor">#</a> Docker常用命令</h1> <h2 id="帮助命令"><a href="#帮助命令" class="header-anchor">#</a> 帮助命令</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker version # 显示 Docker 版本信息。
docker info  # 显示 Docker 系统信息，包括镜像和容器数。。
docker --help # 帮助
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="镜像命令"><a href="#镜像命令" class="header-anchor">#</a> 镜像命令</h2> <h3 id="docker-images"><a href="#docker-images" class="header-anchor">#</a> docker images</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 列出本地主机上的镜像 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker images </span>
REPOSITORY   TAG     IMAGE ID      CREATED SIZE 
hello-world latest bf756fb1ae65 <span class="token number">4</span> months ago <span class="token number">13</span>.3kB 
<span class="token comment"># 解释 </span>
REPOSITORY 镜像的仓库源 
TAG 镜像的标签 
IMAGE ID 镜像的ID 
CREATED 镜像创建时间 
SIZE 镜像大小 
<span class="token comment"># 同一个仓库源可以有多个 TAG，代表这个仓库源的不同版本，我们使用REPOSITORY：TAG 定义不同 的镜像，如果你不定义镜像的标签版本，docker将默认使用 lastest 镜像！ </span>
<span class="token comment"># 可选项 </span>
-a： 列出本地所有镜像 
-q： 只显示镜像id 
--digests： 显示镜像的摘要信息
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="docker-search"><a href="#docker-search" class="header-anchor">#</a> docker search</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code># 搜索镜像 
[root@kuangshen ~]# docker search mysql 
NAME     DESCRIPTION                                       STARS       OFFICIAL 
mysql     MySQL is a widely used, open-source relation…     9484        [OK] 
# docker search 某个镜像的名称 对应DockerHub仓库中的镜像 
# 可选项 
--filter=stars=50 ： 列出收藏数不小于指定值的镜像。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="docker-pull"><a href="#docker-pull" class="header-anchor">#</a> docker pull</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code># 下载镜像 
[root@kuangshen ~]# 
docker pull mysql 
Using default tag: latest # 不写tag，默认是latest 
latest: Pulling from library/mysql 
54fec2fa59d0: Already exists # 分层下载 
bcc6c6145912: Already exists 
951c3d959c9d: Already exists 
05de4d0e206e: Already exists 
319f0394ef42: Already exists 
d9185034607b: Already exists 
013a9c64dadc: Already exists 
42f3f7d10903: Pull complete 
c4a3851d9207: Pull complete
82a1cc65c182: Pull complete 
a0a6b01efa55: Pull complete 
bca5ce71f9ea: Pull complete 
Digest: 
sha256:61a2a33f4b8b4bc93b7b6b9e65e64044aaec594809f818aeffbff69a893d1944 # 签名
Status: Downloaded newer image for mysql:latest 
docker.io/library/mysql:latest # 真实位置 
# 指定版本下载 
[root@kuangshen ~]# docker pull mysql:5.7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="docker-rmi"><a href="#docker-rmi" class="header-anchor">#</a> docker rmi</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker rmi -f 镜像id # 删除单个
docker rmi -f 镜像名:tag 镜像名:tag # 删除多个
docker rmi -f $(docker images -qa) # 删除全部
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="容器命令"><a href="#容器命令" class="header-anchor">#</a> 容器命令</h2> <h3 id="说明-有镜像才能创建容器-我们这里使用-centos-的镜像来测试-就是虚拟一个-centos"><a href="#说明-有镜像才能创建容器-我们这里使用-centos-的镜像来测试-就是虚拟一个-centos" class="header-anchor">#</a> 说明：有镜像才能创建容器，我们这里使用 centos 的镜像来测试，就是虚拟一个 centos ！</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker pull centos
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="新建容器并启动"><a href="#新建容器并启动" class="header-anchor">#</a> 新建容器并启动</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run [OPTIONS] IMAGE [COMMAND][ARG...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 常用参数说明
--name=&quot;Name&quot; # 给容器指定一个名字
-d # 后台方式运行容器，并返回容器的id！
-i # 以交互模式运行容器，通过和 -t 一起使用
-t # 给容器重新分配一个终端，通常和 -i 一起使用
-P # 随机端口映射（大写）
-p # 指定端口映射（小结），一般可以有四种写法
    ip:hostPort:containerPort
    ip::containerPort
    hostPort:containerPort (常用)
    containerPort
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 测试
[root@kuangshen ~]# docker images
REPOSITORY TAG IMAGE ID       CREATED    SIZE
centos latest 470671670cac 3 months ago 237MB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 使用centos进行用交互模式启动容器，在容器内执行/bin/bash命令！
[root@kuangshen ~]# docker run -it centos /bin/bash
[root@dc8f24dd06d0 /]# ls # 注意地址，已经切换到容器内部了！
bin etc lib lost+found mnt proc run srv tmp var
dev home lib64 media opt root sbin sys usr

[root@dc8f24dd06d0 /]# exit # 使用 exit 退出容器 
exit 
[root@kuangshen ~]#
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="列出所有运行的容器"><a href="#列出所有运行的容器" class="header-anchor">#</a> 列出所有运行的容器</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code># 命令 
docker ps [OPTIONS] 

# 常用参数说明 
-a # 列出当前所有正在运行的容器 + 历史运行过的容器 
-l # 显示最近创建的容器 
-n=? # 显示最近n个创建的容器 
-q # 静默模式，只显示容器编号。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="退出容器"><a href="#退出容器" class="header-anchor">#</a> 退出容器</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>exit # 容器停止退出 
ctrl+P+Q # 容器不停止退出
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="启动停止容器"><a href="#启动停止容器" class="header-anchor">#</a> 启动停止容器</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> start <span class="token punctuation">(</span>容器id or 容器名<span class="token punctuation">)</span> <span class="token comment"># 启动容器 </span>
<span class="token function">docker</span> restart <span class="token punctuation">(</span>容器id or 容器名<span class="token punctuation">)</span> <span class="token comment"># 重启容器 </span>
<span class="token function">docker</span> stop <span class="token punctuation">(</span>容器id or 容器名<span class="token punctuation">)</span> <span class="token comment"># 停止容器 </span>
<span class="token function">docker</span> <span class="token function">kill</span> <span class="token punctuation">(</span>容器id or 容器名<span class="token punctuation">)</span> <span class="token comment"># 强制停止容器</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="删除容器"><a href="#删除容器" class="header-anchor">#</a> 删除容器</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token function">rm</span> 容器id <span class="token comment"># 删除指定容器 </span>
<span class="token function">docker</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-q</span><span class="token variable">)</span></span> <span class="token comment"># 删除所有容器 </span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> -q<span class="token operator">|</span><span class="token function">xargs</span> <span class="token function">docker</span> <span class="token function">rm</span> <span class="token comment"># 删除所有容器</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="常用其他命令"><a href="#常用其他命令" class="header-anchor">#</a> 常用其他命令</h2> <h3 id="后台启动容器"><a href="#后台启动容器" class="header-anchor">#</a> 后台启动容器</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> 容器名 

<span class="token comment"># 例子 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> centos <span class="token comment"># 启动centos，使用后台方式启动 </span>

<span class="token comment"># 问题： 使用docker ps 查看，发现容器已经退出了！ </span>
<span class="token comment"># 解释：Docker容器后台运行，就必须有一个前台进程，容器运行的命令如果不是那些一直挂起的命 令，就会自动退出。 </span>
<span class="token comment"># 比如，你运行了nginx服务，但是docker前台没有运行应用，这种情况下，容器启动后，会立即自 杀，因为他觉得没有程序了，所以最好的情况是，将你的应用使用前台进程的方式运行启动。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="查看日志"><a href="#查看日志" class="header-anchor">#</a> 查看日志</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令 </span>
<span class="token function">docker</span> logs <span class="token parameter variable">-f</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">--tail</span> 容器id 

<span class="token comment"># 例子：我们启动 centos，并编写一段脚本来测试玩玩！最后查看日志</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d centos /bin/sh -c &quot;while true;do echo kuangshen;sleep 1;done&quot; </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps </span>
CONTAINER ID      IMAGE 
c8530dbbe3b4      centos 

<span class="token comment"># -t 显示时间戳 </span>
<span class="token comment"># -f 打印最新的日志 </span>
<span class="token comment"># --tail 数字 显示多少条！ </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker logs -tf --tail 10 c8530dbbe3b4 </span>
<span class="token number">2020</span>-05-11T08:46:40.656901941Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:41.658765018Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:42.661015375Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:43.662865628Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:44.664571547Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:45.666718583Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:46.668556725Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:47.670424699Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:48.672324512Z kuangshen 
<span class="token number">2020</span>-05-11T08:46:49.674092766Z kuangshen
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="查看容器中运行的进程信息-支持-ps-命令参数。"><a href="#查看容器中运行的进程信息-支持-ps-命令参数。" class="header-anchor">#</a> 查看容器中运行的进程信息，支持 ps 命令参数。</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令 </span>
<span class="token function">docker</span> <span class="token function">top</span> 容器id 

<span class="token comment"># 测试 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker top c8530dbbe3b4 </span>
<span class="token environment constant">UID</span>     PID    <span class="token environment constant">PPID</span> C STIME TTY TIME    CMD 
root    <span class="token number">27437</span> <span class="token number">27421</span> <span class="token number">0</span> <span class="token number">16</span>:43 ? 00:00:00 /bin/sh <span class="token parameter variable">-c</span> <span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="查看容器-镜像的元数据"><a href="#查看容器-镜像的元数据" class="header-anchor">#</a> 查看容器/镜像的元数据</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令 </span>
<span class="token function">docker</span> inspect 容器id 

<span class="token comment"># 测试 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker inspect c8530dbbe3b4 </span>
<span class="token punctuation">[</span> 
    <span class="token punctuation">{</span> <span class="token comment"># 完整的id，有意思啊，这里上面的容器id，就是截取的这个id前几位！ </span>
    <span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;c8530dbbe3b44a0c873f2566442df6543ed653c1319753e34b400efa05f77cf8&quot;</span>, 
    <span class="token string">&quot;Created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-11T08:43:45.096892382Z&quot;</span>, 
    <span class="token string">&quot;Path&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/bin/sh&quot;</span>, 
    <span class="token string">&quot;Args&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span> 
        <span class="token string">&quot;-c&quot;</span>, 
        <span class="token string">&quot;while true;do echo kuangshen;sleep 1;done&quot;</span> 
    <span class="token punctuation">]</span>,
    <span class="token comment"># 状态 </span>
    <span class="token string">&quot;State&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> 
        <span class="token string">&quot;Status&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;running&quot;</span>, 
        <span class="token string">&quot;Running&quot;</span><span class="token builtin class-name">:</span> true, 
        <span class="token string">&quot;Paused&quot;</span><span class="token builtin class-name">:</span> false, 
        <span class="token string">&quot;Restarting&quot;</span><span class="token builtin class-name">:</span> false, 
        <span class="token string">&quot;OOMKilled&quot;</span><span class="token builtin class-name">:</span> false, 
        <span class="token string">&quot;Dead&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Pid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">27437</span>, 
        <span class="token string">&quot;ExitCode&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
        <span class="token string">&quot;Error&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>, 
        <span class="token string">&quot;StartedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-11T08:43:45.324474622Z&quot;</span>, 
        <span class="token string">&quot;FinishedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0001-01-01T00:00:00Z&quot;</span> 
        <span class="token punctuation">}</span>, 
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="进入正在运行的容器"><a href="#进入正在运行的容器" class="header-anchor">#</a> 进入正在运行的容器</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令1 </span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 容器id bashShell 

<span class="token comment"># 测试1 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps </span>
CONTAINER ID IMAGE      COMMAND             CREATED         STATUS PORTS NAMES 
c8530dbbe3b4 centos <span class="token string">&quot;/bin/sh -c 'while t…&quot;</span> <span class="token number">12</span> minutes ago Up <span class="token number">12</span> minutes happy_chaum 
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it c8530dbbe3b4 /bin/bash </span>
<span class="token punctuation">[</span>root@c8530dbbe3b4 /<span class="token punctuation">]</span><span class="token comment"># ps -ef</span>
    <span class="token environment constant">UID</span> PID <span class="token environment constant">PPID</span> C STIME TTY TIME CMD 
    root <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> 08:43 ? 00:00:00 /bin/sh <span class="token parameter variable">-c</span> <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> kuangshen<span class="token punctuation">;</span><span class="token function">sleep</span> 
    root <span class="token number">751</span> <span class="token number">0</span> <span class="token number">0</span> 08:56 pts/0 00:00:00 /bin/bash 
    root <span class="token number">769</span> <span class="token number">1</span> <span class="token number">0</span> 08:56 ? 00:00:00 /usr/bin/coreutils -- coreutils-prog-shebang<span class="token operator">=</span>s 
    root <span class="token number">770</span> <span class="token number">751</span> <span class="token number">0</span> 08:56 pts/0 00:00:00 <span class="token function">ps</span> <span class="token parameter variable">-ef</span> 
 
 <span class="token comment"># 命令2 </span>
 <span class="token function">docker</span> attach 容器id 
 
 <span class="token comment"># 测试2 </span>
 <span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it c8530dbbe3b4 /bin/bash </span>
 <span class="token punctuation">[</span>root@c8530dbbe3b4 /<span class="token punctuation">]</span><span class="token comment"># ps -ef </span>
 <span class="token environment constant">UID</span> PID <span class="token environment constant">PPID</span> C STIME TTY TIME CMD 
 root <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> 08:43 ? 00:00:00 /bin/sh <span class="token parameter variable">-c</span> <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> kuangshen<span class="token punctuation">;</span><span class="token function">sleep</span> 
 root <span class="token number">856</span> <span class="token number">0</span> <span class="token number">0</span> 08:57 pts/0 00:00:00 /bin/bash 
 root <span class="token number">874</span> <span class="token number">1</span> <span class="token number">0</span> 08:57 ? 00:00:00 /usr/bin/coreutils -- coreutils-prog-shebang<span class="token operator">=</span>s 
 root <span class="token number">875</span> <span class="token number">856</span> <span class="token number">0</span> 08:57 pts/0 00:00:00 <span class="token function">ps</span> <span class="token parameter variable">-ef</span> 
 
 <span class="token comment"># 区别 </span>
 <span class="token comment"># exec 是在容器中打开新的终端，并且可以启动新的进程 </span>
 <span class="token comment"># attach 直接进入容器启动命令的终端，不会启动新的进程</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="从容器内拷贝文件到主机上"><a href="#从容器内拷贝文件到主机上" class="header-anchor">#</a> 从容器内拷贝文件到主机上</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令 </span>
<span class="token function">docker</span> <span class="token function">cp</span> 容器id:容器内路径 目的主机路径 

<span class="token comment"># 测试 </span>
<span class="token comment"># 容器内执行，创建一个文件测试 </span>
<span class="token punctuation">[</span>root@c8530dbbe3b4 /<span class="token punctuation">]</span><span class="token comment"># cd /home </span>
<span class="token punctuation">[</span>root@c8530dbbe3b4 home<span class="token punctuation">]</span><span class="token comment"># touch f1 </span>
<span class="token punctuation">[</span>root@c8530dbbe3b4 home<span class="token punctuation">]</span><span class="token comment"># ls</span>
f1
<span class="token punctuation">[</span>root@c8530dbbe3b4 home<span class="token punctuation">]</span><span class="token comment"># exit exit </span>

<span class="token comment"># linux复制查看，是否复制成功 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker cp c8530dbbe3b4:/home/f1 /home </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># cd /home </span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># ls </span>
f1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="小结-2"><a href="#小结-2" class="header-anchor">#</a> 小结</h2> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719165346.png" alt="img"></p> <h3 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>attach Attach to a running container <span class="token comment"># 当前 shell 下 </span>
attach 连接指定运行镜像 build Build an image from a Dockerfile <span class="token comment"># 通过 Dockerfile 定 制镜像 </span>
commit Create a new image from a container changes <span class="token comment"># 提交当前容器为新的镜像 </span>
<span class="token function">cp</span> Copy files/folders from the containers filesystem to the <span class="token function">host</span> path <span class="token comment">#从容器中拷贝指定文件或者目录到宿主机中 </span>
create Create a new container <span class="token comment"># 创建一个新的容器，同 run，但不启动容器 </span>
<span class="token function">diff</span> Inspect changes on a container's filesystem <span class="token comment"># 查看 docker 容器变化 </span>
events Get real <span class="token function">time</span> events from the server <span class="token comment"># 从 docker 服务获取容 器实时事件 </span>
<span class="token builtin class-name">exec</span> Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> an existing container <span class="token comment"># 在已存在的容器上运行命 令</span>
<span class="token builtin class-name">export</span> Stream the contents of a container as a <span class="token function">tar</span> archive <span class="token comment"># 导出容器的内 容流作为一个 tar 归档文件[对应 import ] </span>
<span class="token function">history</span> Show the <span class="token function">history</span> of an image <span class="token comment"># 展示一个镜像形成历史 </span>
images List images <span class="token comment"># 列出系统当前镜像</span>
<span class="token function">import</span> Create a new filesystem image from the contents of a tarball <span class="token comment"># 从 tar包中的内容创建一个新的文件系统映像[对应export] </span>
info Display system-wide information <span class="token comment"># 显示系统相关信息 </span>
inspect Return low-level information on a container <span class="token comment"># 查看容器详细信息 </span>
<span class="token function">kill</span> Kill a running container <span class="token comment"># kill 指定 docker 容 器</span>
load Load an image from a <span class="token function">tar</span> archive <span class="token comment"># 从一个 tar 包中加载一 个镜像[对应 save] </span>
login Register or Login to the <span class="token function">docker</span> registry server <span class="token comment"># 注册或者登陆一个 docker 源服务器 </span>
<span class="token builtin class-name">logout</span> Log out from a Docker registry server <span class="token comment"># 从当前 Docker registry 退出 </span>
logs Fetch the logs of a container <span class="token comment"># 输出当前容器日志信息 </span>
port Lookup the public-facing port <span class="token function">which</span> is NAT-ed to PRIVATE_PORT <span class="token comment"># 查看映射端口对应的容器内部源端口 </span>
pause Pause all processes within a container <span class="token comment"># 暂停容器 </span>
<span class="token function">ps</span> List containers <span class="token comment"># 列出容器列表 </span>
pull Pull an image or a repository from the <span class="token function">docker</span> registry server <span class="token comment"># 从docker镜像源服务器拉取指定镜像或者库镜像 </span>
push Push an image or a repository to the <span class="token function">docker</span> registry server <span class="token comment"># 推送指定镜像或者库镜像至docker源服务器 </span>
restart Restart a running container <span class="token comment"># 重启运行的容器 </span>
<span class="token function">rm</span> Remove one or <span class="token function">more</span> containers <span class="token comment"># 移除一个或者多个容器 </span>
rmi Remove one or <span class="token function">more</span> images <span class="token comment"># 移除一个或多个镜像[无容器使用该 镜像才可删除，否则需删除相关容器才可继续或 -f 强制删除] </span>
run Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> a new container <span class="token comment"># 创建一个新的容器并运行 一个命令 </span>
save Save an image to a <span class="token function">tar</span> archive <span class="token comment"># 保存一个镜像为一个 tar 包[对应 load] </span>
search Search <span class="token keyword">for</span> an image on the Docker Hub <span class="token comment"># 在 docker hub 中搜 索镜像 </span>
start Start a stopped containers <span class="token comment"># 启动容器 </span>
stop Stop a running containers <span class="token comment"># 停止容器 </span>
tag Tag an image into a repository <span class="token comment"># 给源中镜像打标签 </span>
<span class="token function">top</span> Lookup the running processes of a container <span class="token comment"># 查看容器中运行的进程信 息</span>
unpause Unpause a paused container <span class="token comment"># 取消暂停容器 </span>
version Show the <span class="token function">docker</span> version information <span class="token comment"># 查看 docker 版本号 </span>
<span class="token function">wait</span> Block <span class="token keyword">until</span> a container stops, <span class="token keyword">then</span> print its <span class="token builtin class-name">exit</span> code <span class="token comment"># 截取容 器停止时的退出状态值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="作业练习"><a href="#作业练习" class="header-anchor">#</a> 作业练习</h2> <h3 id="使用docker-安装-nginx"><a href="#使用docker-安装-nginx" class="header-anchor">#</a> 使用Docker 安装 Nginx</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1、搜索镜像 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker search nginx </span>
NAME  DESCRIPTION              STARS OFFICIAL 
nginx Official build of Nginx. <span class="token number">13159</span> <span class="token punctuation">[</span>OK<span class="token punctuation">]</span> 
<span class="token comment"># 2、拉取镜像 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker pull nginx </span>
Using default tag: latest
latest: Pulling from library/nginx 
54fec2fa59d0: Pull complete 
4ede6f09aefe: Pull complete 
f9dc69acb465: Pull complete 
Digest: 
sha256:86ae264c3f4acb99b2dee4d0098c40cb8c46dcf9e1148f05d3a51c4df6758c12 
Status: Downloaded newer image <span class="token keyword">for</span> nginx:latest 
docker.io/library/nginx:latest 

<span class="token comment"># 3、启动容器 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker images </span>
REPOSITORY TAG    IMAGE ID    CREATED      SIZE 
diytomcat latest ffdf6529937d <span class="token number">3</span> hours ago 636MB 
nginx     latest 602e111c06b6 <span class="token number">2</span> weeks ago 127MB 
centos    latest 470671670cac <span class="token number">3</span> months ago 237MB 
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d --name mynginx -p 3500:80 nginx </span>
a95d5f2f057fc609082cfa0de906bd690f95c43a26d38420d081f0e255b232ec 
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps </span>
CONTAINER ID IMAGE PORTS                NAMES 
a95d5f2f057f nginx <span class="token number">0.0</span>.0.0:3500-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp mynginx 

<span class="token comment"># 4、测试访问 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># curl localhost:3500 </span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span> <span class="token comment"># ok .... </span>
<span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span> 

<span class="token comment"># 5、进入容器 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it mynginx /bin/bash </span>
root@a95d5f2f057f:/<span class="token comment"># whereis nginx # 寻找nginx </span>
nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx 
root@a95d5f2f057f:/<span class="token comment"># cd /usr/share/nginx # nginx 的路径 </span>
root@a95d5f2f057f:/usr/share/nginx<span class="token comment"># ls </span>
html 
root@a95d5f2f057f:/usr/share/nginx<span class="token comment"># cd html # 首页的位置 </span>
root@a95d5f2f057f:/usr/share/nginx/html<span class="token comment"># ls </span>
50x.html index.html 
root@a95d5f2f057f:/usr/share/nginx/html<span class="token comment"># cat index.html </span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span> 
body <span class="token punctuation">{</span>
    width: 35em<span class="token punctuation">;</span> 
    margin: <span class="token number">0</span> auto<span class="token punctuation">;</span> 
    font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
<span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span> 
<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><h3 id="使用docker安装-tomcat"><a href="#使用docker安装-tomcat" class="header-anchor">#</a> 使用docker安装 tomcat</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 官方文档解释 </span>
<span class="token comment"># -it ：交互模式 </span>
<span class="token comment"># --rm：容器启动成功并退出以后容器就自动移除，一般在测试情况下使用！ </span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--rm</span> tomcat:9.0 

<span class="token comment"># 1、下载tomcat镜像 </span>
<span class="token function">docker</span> pull tomcat 

<span class="token comment"># 2、启动 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 <span class="token parameter variable">--name</span> tomcat9 tomcat 

<span class="token comment"># 3、进入tomcat </span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> tomcat9 /bin/bash 

<span class="token comment"># 4、思考：我们以后要部署项目，还需要进入容器中，是不是十分麻烦，要是有一种技术，可以将容器 </span>
内和我们Linux进行映射挂载就好了？我们后面会将数据卷技术来进行挂载操作，也是一个核心内容，这 
里大家先听听名词就好，我们很快就会讲到！
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="使用docker-部署-es-kibana"><a href="#使用docker-部署-es-kibana" class="header-anchor">#</a> 使用docker 部署 es + kibana</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 我们启动es这种容器需要考虑几个问题 </span>
<span class="token number">1</span>、端口暴露问题 <span class="token number">9200</span>、9300 
<span class="token number">2</span>、数据卷的挂载问题 data、plugins、conf 
<span class="token number">3</span>、吃内存 - <span class="token string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span> 

<span class="token comment"># 扩展命令 </span>
<span class="token function">docker</span> stats 容器id <span class="token comment"># 查看容器的cpu内存和网络状态 </span>

<span class="token comment"># 1、启动es测试 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> elasticsearch <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token parameter variable">-e</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> elasticsearch:7.6.2 

<span class="token comment"># 2、启动之后很卡，使用 docker stats 容器id 查看下cpu状态 ，发现占用的很大 </span>
CONTAINER ID NAME          CPU % MEM USAGE / LIMIT   MEM % 
249ae46da625 elasticsearch <span class="token number">0.00</span>% <span class="token number">1</span>.036GiB / <span class="token number">1</span>.716GiB <span class="token number">60.37</span>% 

<span class="token comment"># 3、测试访问 </span>
<span class="token punctuation">[</span>root@kuangshen data<span class="token punctuation">]</span><span class="token comment"># curl localhost:9200 </span>
<span class="token punctuation">{</span> 
    <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;249ae46da625&quot;</span>, 
    <span class="token string">&quot;cluster_name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;docker-cluster&quot;</span>, 
    <span class="token string">&quot;cluster_uuid&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;_Ho_i4fOTUesNc_II35sSA&quot;</span>, 
    <span class="token string">&quot;version&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> 
        <span class="token string">&quot;number&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;7.6.2&quot;</span>, 
        <span class="token string">&quot;build_flavor&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>, 
        <span class="token string">&quot;build_type&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;docker&quot;</span>, 
        <span class="token string">&quot;build_hash&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;</span>, 
        <span class="token string">&quot;build_date&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;2020-03-26T06:34:37.794943Z&quot;</span>,
        <span class="token string">&quot;build_snapshot&quot;</span> <span class="token builtin class-name">:</span> false, 
        <span class="token string">&quot;lucene_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;8.4.0&quot;</span>, 
        <span class="token string">&quot;minimum_wire_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.8.0&quot;</span>, 
        <span class="token string">&quot;minimum_index_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span> 
        <span class="token punctuation">}</span>,
    <span class="token string">&quot;tagline&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># 4、增加上内存限制启动 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> elasticsearch <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token parameter variable">-e</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms64m -Xmx512m&quot;</span> elasticsearch:7.6.2 

<span class="token comment"># 5、启动之后，使用 docker stats 查看下cpu状态 </span>
CONTAINER ID NAME          CPU % MEM USAGE / LIMIT MEM % 
d2860684e7e4 elasticsearch <span class="token number">0.24</span>% <span class="token number">358</span>.3MiB / <span class="token number">1</span>.716GiB <span class="token number">20.40</span>% 

<span class="token comment"># 6、测试访问，效果一样，ok！ </span>
<span class="token punctuation">[</span>root@kuangshen data<span class="token punctuation">]</span><span class="token comment"># curl localhost:9200 </span>
<span class="token comment"># 思考：如果我们要使用 kibana , 如果配置连接上我们的es呢？网络该如何配置呢？</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719172742.png" alt="img"></p> <h2 id="可视化"><a href="#可视化" class="header-anchor">#</a> 可视化</h2> <h3 id="portainer-先用这个"><a href="#portainer-先用这个" class="header-anchor">#</a> Portainer（先用这个）</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -d -p 8088:9000 \ --restart=always -v /var/run/docker.sock:/var/run/docker.sock -- privileged=true portainer/portainer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="rancher-ci-cd再用这个"><a href="#rancher-ci-cd再用这个" class="header-anchor">#</a> Rancher（CI/CD再用这个）</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#安装rancher-server </span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> rancher-server <span class="token parameter variable">-p</span> <span class="token number">8000</span>:8080 <span class="token parameter variable">-v</span> /etc/localtime:/etc/localtime:ro <span class="token parameter variable">-d</span> rancher/server 
<span class="token comment">#安装agent </span>
<span class="token function">docker</span> run <span class="token parameter variable">--rm</span> <span class="token parameter variable">--privileged</span> <span class="token parameter variable">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="token parameter variable">-v</span> /var/lib/rancher:/var/lib/rancher rancher/agent:v1.2.11 
http://39.101.191.131:8000/v1/scripts/D3DBD43F263109BB881F:1577750400000:7M0y BzCw4XSxJklD7TpysYIpI
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍：</h3> <blockquote><p>Portainer是Docker的图形化管理工具，提供状态显示面板、应用模板快速部署、容器镜像网络数据卷
的基本操作（包括上传下载镜像，创建容器等操作）、事件日志显示、容器控制台操作、Swarm集群和
服务等集中管理和操作、登录用户管理和控制等功能。功能十分全面，基本能满足中小型单位对容器管
理的全部需求。
如果仅有一个docker宿主机，则可使用单机版运行，Portainer单机版运行十分简单，只需要一条语句即
可启动容器，来管理该机器上的docker镜像、容器等数据。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -d -p 8088:9000 \ --restart=always -v /var/run/docker.sock:/var/run/docker.sock -- privileged=true portainer/portainer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="访问方式-http-ip-8088"><a href="#访问方式-http-ip-8088" class="header-anchor">#</a> 访问方式：http://IP:8088</h3> <h3 id="首次登陆需要注册用户-给admin用户设置密码"><a href="#首次登陆需要注册用户-给admin用户设置密码" class="header-anchor">#</a> 首次登陆需要注册用户，给admin用户设置密码：</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719173804.png" alt="img"></p> <h3 id="单机版这里选择local即可-选择完毕-点击connect即可连接到本地docker"><a href="#单机版这里选择local即可-选择完毕-点击connect即可连接到本地docker" class="header-anchor">#</a> 单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker：</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719173821.png" alt="img"></p> <h3 id="登录成功"><a href="#登录成功" class="header-anchor">#</a> 登录成功！</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719173908.png" alt="img"></p> <h3 id="我们可以点击可视化界面来玩玩"><a href="#我们可以点击可视化界面来玩玩" class="header-anchor">#</a> 我们可以点击可视化界面来玩玩！</h3> <h1 id="docker镜像讲解"><a href="#docker镜像讲解" class="header-anchor">#</a> Docker镜像讲解</h1> <h2 id="镜像是什么"><a href="#镜像是什么" class="header-anchor">#</a> 镜像是什么</h2> <blockquote><p>镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含
运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。</p></blockquote> <h2 id="docker镜像加载原理"><a href="#docker镜像加载原理" class="header-anchor">#</a> Docker镜像加载原理</h2> <h3 id="unionfs-联合文件系统"><a href="#unionfs-联合文件系统" class="header-anchor">#</a> UnionFS （联合文件系统）</h3> <blockquote><p>UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，
它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系
统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基
础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。
特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件
系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</p></blockquote> <h3 id="docker镜像加载原理-2"><a href="#docker镜像加载原理-2" class="header-anchor">#</a> Docker镜像加载原理</h3> <blockquote><p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。<br>
bootfs(boot file system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux刚启<br>
动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Unix系统是<br>
一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已<br>
由bootfs转交给内核，此时系统也会卸载bootfs。 rootfs (root file system) ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标<br>
准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719174045.png" alt="img"></p> <h3 id="平时我们安装进虚拟机的centos都是好几个g-为什么docker这里才200m"><a href="#平时我们安装进虚拟机的centos都是好几个g-为什么docker这里才200m" class="header-anchor">#</a> 平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719174107.png" alt="img"></p> <p>对于一个精简的OS，rootfs 可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直
接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版, bootfs基本是一
致的, rootfs会有差别, 因此不同的发行版可以公用bootfs。</p> <h2 id="分层理解"><a href="#分层理解" class="header-anchor">#</a> 分层理解</h2> <h3 id="分层的镜像"><a href="#分层的镜像" class="header-anchor">#</a> 分层的镜像</h3> <blockquote><p>我们可以去下载一个镜像，注意观察下载的日志输出，可以看到是一层一层的在下载！</p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719174629.png" alt="img"></p> <blockquote><p>思考：为什么Docker镜像要采用这种分层的结构呢？<br>
最大的好处，我觉得莫过于是资源共享了！比如有多个镜像都从相同的Base镜像构建而来，那么宿主机<br>
只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服<br>
务了，而且镜像的每一层都可以被共享。<br>
查看镜像分层的方式可以通过 docker image inspect 命令！</p></blockquote> <h3 id="理解"><a href="#理解" class="header-anchor">#</a> 理解：</h3> <blockquote><p>所有的 Docker 镜像都起始于一个基础镜像层，当进行修改或增加新的内容时，就会在当前镜像层之<br>
上，创建新的镜像层。<br>
举一个简单的例子，假如基于 Ubuntu Linux 16.04 创建一个新的镜像，这就是新镜像的第一层；如果<br>
在该镜像中添加 Python包，就会在基础镜像层之上创建第二个镜像层；如果继续添加一个安全补丁，就<br>
会创建第三个镜像层。<br>
该镜像当前已经包含 3 个镜像层，如下图所示（这只是一个用于演示的很简单的例子）。<br></p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719175444.png" alt="img"></p> <blockquote><p>在添加额外的镜像层的同时，镜像始终保持是当前所有镜像的组合，理解这一点非常重要。下图中举了<br>
一个简单的例子，每个镜像层包含 3 个文件，而镜像包含了来自两个镜像层的 6 个文件。<br></p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719175635.png" alt="img"></p> <blockquote><p>上图中的镜像层跟之前图中的略有区别，主要目的是便于展示文件。<br>
下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有 6 个文件，这是因为最上层中的文件<br>
7 是文件 5 的一个更新版本。</p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719180003.png" alt="img"></p> <blockquote><p>这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新<br>
镜像层添加到镜像当中。<br>
Docker 通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统<br>
一的文件系统。<br>
Linux 上可用的存储引擎有 AUFS、Overlay2、Device Mapper、Btrfs 以及 ZFS。顾名思义，每种存储<br>
引擎都基于 Linux 中对应的文件系统或者块设备技术，并且每种存储引擎都有其独有的性能特点。<br>
Docker 在 Windows 上仅支持 windowsfilter 一种存储引擎，该引擎基于 NTFS 文件系统之上实现了分<br>
层和 CoW[1]。<br>
下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供统一的视图。<br></p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719180119.png" alt="img"></p> <h3 id="特点"><a href="#特点" class="header-anchor">#</a> 特点</h3> <blockquote><p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部！<br>
这一层就是我们通常说的容器层，容器之下的都叫镜像层！</p></blockquote> <h2 id="镜像commit"><a href="#镜像commit" class="header-anchor">#</a> 镜像Commit</h2> <h3 id="docker-commit-从容器创建一个新的镜像。"><a href="#docker-commit-从容器创建一个新的镜像。" class="header-anchor">#</a> docker commit 从容器创建一个新的镜像。</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> commit 提交容器副本使之成为一个新的镜像！ 
<span class="token comment"># 语法 </span>
<span class="token function">docker</span> commit <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">&quot;提交的描述信息&quot;</span> <span class="token parameter variable">-a</span><span class="token operator">=</span><span class="token string">&quot;作者&quot;</span> 容器id 要创建的目标镜像名:<span class="token punctuation">[</span>标签名<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="测试"><a href="#测试" class="header-anchor">#</a> 测试</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1、从Docker Hub 下载tomcat镜像到本地并运行 -it 交互终端 -p 端口映射</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span> :8080 tomcat

<span class="token comment"># 注意：坑爹：docker启动官方tomcat镜像的容器，发现 404 是因为使用了加速器，而加速器里的tomcat的webapps下没有root等文件！</span>
<span class="token comment"># 下载tomcat官方镜像，就是这个镜像（阿里云里的tomcat的webapps下没有任何文件）</span>
<span class="token comment"># 进入tomcat查看cd到webapps下发现全部空的，反而有个webapps.dist里有对应文件，cp -r到webapps下！</span>
root@aba865b53114:/usr/local/tomcat<span class="token comment"># cp -r webapps.dist/* webapps</span>

<span class="token comment"># 2、删除上一步镜像产生的tomcat容器的文档</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token comment"># 查看容器id</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 容器id /bin/bash
/usr/local/tomcat <span class="token comment"># ce webapps/</span>
/usr/local/tomcat/webapps <span class="token comment"># ls -l # 查看是否存在 docs文件夹</span>
/usr/local/tomcat/webapps <span class="token comment"># curl localhost:8080/docs/ # 可以看到 docs 返回的内容</span>
/usr/local/tomcat/webapps <span class="token comment"># rm -rf docs # 删除它</span>
/usr/local/tomcat/webapps <span class="token comment"># curl localhost:8080/docs/ # 再次访问返回 404</span>

<span class="token comment"># 3、当前运行的tomcat实例就是一个没有docs的容器，我们使用它为模板commit一个没有docs的tomcat新镜像， tomcat02</span>

<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-l</span> <span class="token comment"># 查看容器的id</span>

<span class="token comment"># 注意：commit的时候，容器的名字不能有大写，否则报错：invalid reference format</span>
<span class="token function">docker</span> commit <span class="token parameter variable">-a</span><span class="token operator">=</span><span class="token string">&quot;kuangshen&quot;</span> <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">&quot;no tomcat docs&quot;</span> 1e98a2f815b0 tomcat02:1.1
sha256:cdccd4674f93ad34bf73d9db577a20f027a6d03fd1944dc0e628ee4bf17ec748
<span class="token punctuation">[</span>root@kuangshen /<span class="token punctuation">]</span><span class="token comment"># docker images # 查看，我们自己提交的镜像已经OK了！</span>
REPOSITORY TAG IMAGE ID CREATED
SIZE
tomcat02 <span class="token number">1</span> .1 cdccd4674f93 About a minute
ago 649MB
redis latest f9b990972689 <span class="token number">9</span> days ago
104MB
tomcat latest 927899a31456 <span class="token number">2</span> weeks ago
647MB
centos latest 470671670cac <span class="token number">3</span> months ago
237MB

<span class="token comment"># 4、这个时候，我们的镜像都是可以使用的，大家可以启动原来的tomcat，和我们新的tomcat02来 测试看看！</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -it -p 8080:8080 tomcat02:1.1</span>

<span class="token comment"># 如果你想要保存你当前的状态，可以通过commit，来提交镜像，方便使用，类似于 VM 中的快照！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h1 id="容器数据卷"><a href="#容器数据卷" class="header-anchor">#</a> 容器数据卷</h1> <h2 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="header-anchor">#</a> 什么是容器数据卷</h2> <h3 id="docker的理念回顾"><a href="#docker的理念回顾" class="header-anchor">#</a> docker的理念回顾：</h3> <blockquote><p>将应用和运行的环境打包形成容器运行，运行可以伴随着容器，但是我们对于数据的要求，是希望能够<br>
持久化的！<br>
就好比，你安装一个MySQL，结果你把容器删了，就相当于删库跑路了，这TM也太扯了吧！<br>
所以我们希望容器之间有可能可以共享数据，Docker容器产生的数据，如果不通过docker commit 生成<br>
新的镜像，使得数据作为镜像的一部分保存下来，那么当容器删除后，数据自然也就没有了！这样是行<br>
不通的！<br>
为了能保存数据在Docker中我们就可以使用卷！让数据挂载到我们本地！这样数据就不会因为容器删除<br>
而丢失了！<br></p> <h3 id="作用"><a href="#作用" class="header-anchor">#</a> 作用：<br></h3></blockquote> <p>卷就是目录或者文件，存在一个或者多个容器中，由docker挂载到容器，但不属于联合文件系统，因此<br>
能够绕过 Union File System ， 提供一些用于持续存储或共享数据的特性：<br>
卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂
载的数据卷。<br></p> <h3 id="特点-2"><a href="#特点-2" class="header-anchor">#</a> 特点：</h3> <ul><li>1、数据卷可在容器之间共享或重用数据</li> <li>2、卷中的更改可以直接生效</li> <li>3、数据卷中的更改不会包含在镜像的更新中</li> <li>4、数据卷的生命周期一直持续到没有容器使用它为止</li></ul> <h3 id="所以-总结一句话-就是容器的持久化-以及容器间的继承和数据共享"><a href="#所以-总结一句话-就是容器的持久化-以及容器间的继承和数据共享" class="header-anchor">#</a> 所以：总结一句话： 就是容器的持久化，以及容器间的继承和数据共享！</h3> <h2 id="使用数据卷"><a href="#使用数据卷" class="header-anchor">#</a> 使用数据卷</h2> <h3 id="方式一-容器中直接使用命令来添加"><a href="#方式一-容器中直接使用命令来添加" class="header-anchor">#</a> 方式一：容器中直接使用命令来添加</h3> <h3 id="挂载"><a href="#挂载" class="header-anchor">#</a> 挂载</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">-v</span> 宿主机绝对路径目录:容器内目录 镜像名 

<span class="token comment"># 测试 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -it -v /home/ceshi:/home centos /bin/bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="查看数据卷是否挂载成功-docker-inspect-容器id"><a href="#查看数据卷是否挂载成功-docker-inspect-容器id" class="header-anchor">#</a> 查看数据卷是否挂载成功 docker inspect 容器id</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719181004.png" alt="img"></p> <h3 id="测试容器和宿主机之间数据共享-可以发现-在容器中-创建的会在宿主机中看到"><a href="#测试容器和宿主机之间数据共享-可以发现-在容器中-创建的会在宿主机中看到" class="header-anchor">#</a> 测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到！</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719181033.png" alt="img"></p> <h3 id="测试容器停止退出后-主机修改数据是否会同步"><a href="#测试容器停止退出后-主机修改数据是否会同步" class="header-anchor">#</a> 测试容器停止退出后，主机修改数据是否会同步！</h3> <ul><li><ol><li>停止容器</li></ol></li> <li><ol start="2"><li>在宿主机上修改文件，增加些内容</li></ol></li> <li><ol start="3"><li>启动刚才停止的容器</li></ol></li> <li><ol start="4"><li>然后查看对应的文件，发现数据依旧同步！ok</li></ol></li></ul> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719181118.png" alt="img"></p> <h3 id="使用-docker-安装-mysql"><a href="#使用-docker-安装-mysql" class="header-anchor">#</a> 使用 docker 安装 mysql</h3> <h3 id="思考-mysql-数据持久化的问题"><a href="#思考-mysql-数据持久化的问题" class="header-anchor">#</a> 思考：mysql 数据持久化的问题！</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1、搜索镜像</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker search mysql</span>
NAME DESCRIPTION
STARS
mysql MySQL is a widely used, open-source
relation<span class="token punctuation">..</span>. <span class="token number">9488</span>

<span class="token comment"># 2、拉取镜像</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql:5.7</span>
<span class="token number">5</span> .7: Pulling from library/mysql
54fec2fa59d0: Already exists
bcc6c6145912: Pull complete
951c3d959c9d: Pull complete
05de4d0e206e: Pull complete
319f0394ef42: Pull complete
d9185034607b: Pull complete
013a9c64dadc: Pull complete
e745b3361626: Pull complete
03145d87b451: Pull complete
3991a6b182ee: Pull complete
62335de06f7d: Pull complete
Digest:
sha256:e821ca8cc7a44d354486f30c6a193ec6b70a4eed8c8362aeede4e9b8d74b8ebb
Status: Downloaded newer image <span class="token keyword">for</span> mysql:5.7
docker.io/library/mysql:5.7

<span class="token comment"># 3、启动容器 -e 环境变量！</span>
<span class="token comment"># 注意： mysql的数据应该不丢失！先体验下 -v 挂载卷！ 参考官方文档</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span>
4763fa5c68c4323688102f57938fb10996a0fb902d2812349286529f9378f16c

<span class="token comment"># 4、使用本地的sqlyog连接测试一下 3310</span>

<span class="token comment"># 5、查看本地的 /home/mysql 目录</span>
<span class="token punctuation">[</span>root@kuangshen data<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/home/mysql/data
<span class="token punctuation">[</span>root@kuangshen data<span class="token punctuation">]</span><span class="token comment"># ls</span>
<span class="token punctuation">..</span> <span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token builtin class-name">test</span>  <span class="token comment"># 可以看到我们刚刚建立的mysql数据库在本地存储着</span>

<span class="token comment"># 6、删除mysql容器</span>
<span class="token punctuation">[</span>root@kuangshen data<span class="token punctuation">]</span><span class="token comment"># docker rm -f mysql01 # 删除容器，然后发现远程连接失败！</span>
mysql01
<span class="token punctuation">[</span>root@kuangshen data<span class="token punctuation">]</span><span class="token comment"># ls</span>
<span class="token punctuation">..</span> <span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token builtin class-name">test</span> <span class="token comment"># 可以看到我们刚刚建立的mysql数据库在本地存储着</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="通过docker-file-来添加-了解"><a href="#通过docker-file-来添加-了解" class="header-anchor">#</a> 通过Docker File 来添加（了解）</h3> <blockquote><p>DockerFile 是用来构建Docker镜像的构建文件，是由一些列命令和参数构成的脚本。
我们在这里，先体验下，后面我们会详细讲解 DockerFile ！</p></blockquote> <p>测试：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1、我们在宿主机 /home 目录下新建一个 docker-test-volume文件夹</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># mkdir docker-test-volume</span>

<span class="token comment"># 说明：在编写DockerFile文件中使用 VOLUME 指令来给镜像添加一个或多个数据卷</span>
VOLUME<span class="token punctuation">[</span><span class="token string">&quot;/dataVolumeContainer1&quot;</span>,<span class="token string">&quot;/dataVolumeContainer2&quot;</span>,<span class="token string">&quot;/dataVolumeContainer3&quot;</span><span class="token punctuation">]</span>
<span class="token comment"># 出于可移植和分享的考虑，我们之前使用的 -v 主机目录:容器目录 这种方式不能够直接在DockerFile中实现。</span>
<span class="token comment"># 由于宿主机目录是依赖于特定宿主机的，并不能够保证在所有宿主机上都存在这样的特定目录.</span>

<span class="token comment"># 2、编写DockerFile文件</span>
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/home/docker-test-volume
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># vim dockerfile1</span>
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># cat dockerfile1</span>
<span class="token comment"># volume test</span>
FROM centos
VOLUME <span class="token punctuation">[</span><span class="token string">&quot;/dataVolumeContainer1&quot;</span>,<span class="token string">&quot;/dataVolumeContainer2&quot;</span><span class="token punctuation">]</span>
CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;-------end------&quot;</span>
CMD /bin/bash

<span class="token comment"># 3、build后生成镜像，获得一个新镜像 kuangshen/centos</span>

<span class="token function">docker</span> build <span class="token parameter variable">-f</span> /home/docker-test-volume/dockerfile1 <span class="token parameter variable">-t</span> kuangshen/centos. <span class="token comment">#注意最后有个.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719181842.png" alt="img"></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 4、启动容器</span>
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker run -it 0e97e1891a3d /bin/bash #启动容器</span>

<span class="token punctuation">[</span>root@f5824970eefc /<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">56</span>
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">7</span> May <span class="token number">11</span>  <span class="token number">2019</span> bin -<span class="token operator">&gt;</span> usr/bin
drwxr-xr-x <span class="token number">2</span> root root <span class="token number">4096</span> May <span class="token number">11</span> <span class="token number">11</span> :55 dataVolumeContainer1 <span class="token comment"># 数据卷目录</span>
drwxr-xr-x <span class="token number">2</span> root root <span class="token number">4096</span> May <span class="token number">11</span> <span class="token number">11</span> :55 dataVolumeContainer2 <span class="token comment"># 数据卷目录</span>
drwxr-xr-x <span class="token number">5</span> root root <span class="token number">360</span> May <span class="token number">11</span> <span class="token number">11</span> :55 dev
drwxr-xr-x <span class="token number">1</span> root root <span class="token number">4096</span> May <span class="token number">11</span> <span class="token number">11</span> :55 etc
drwxr-xr-x <span class="token number">2</span> root root <span class="token number">4096</span> May <span class="token number">11</span>  <span class="token number">2019</span> home
<span class="token punctuation">..</span><span class="token punctuation">..</span>.

<span class="token comment"># 问题:通过上述步骤，容器内的卷目录地址就已经知道了，但是对应的主机目录地址在哪里呢？</span>

<span class="token comment"># 5、我们在数据卷中新建一个文件</span>
<span class="token punctuation">[</span>root@f5824970eefc dataVolumeContainer1<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/dataVolumeContainer1
<span class="token punctuation">[</span>root@f5824970eefc dataVolumeContainer1<span class="token punctuation">]</span><span class="token comment"># touch container.txt</span>
<span class="token punctuation">[</span>root@f5824970eefc dataVolumeContainer1<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">11</span> :58 container.txt

<span class="token comment"># 6、查看下这个容器的信息</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker inspect 0e97e1891a3d</span>
<span class="token comment"># 查看输出的Volumes</span>
<span class="token string">&quot;Volumes&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;/dataVolumeContainer1&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
<span class="token string">&quot;/dataVolumeContainer2&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>,

<span class="token comment"># 7、这个卷在主机对应的默认位置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210719182127.png" alt="img"></p> <blockquote><p>注意：如果访问出现了 cannot open directory: Permission denied
解决办法：在挂载目录后多加一个 --privileged=true参数即可</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 匿名挂载 -v 容器内路径 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx01 <span class="token parameter variable">-v</span> /etc/nginx nginx 

<span class="token comment"># 匿名挂载的缺点，就是不好维护，通常使用命令 docker volume维护 </span>
<span class="token function">docker</span> volume <span class="token function">ls</span> 

<span class="token comment"># 具名挂载 -v 卷名:/容器内路径 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> nginxconfig:/etc/nginx nginx 

<span class="token comment"># 查看挂载的路径 </span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker volume inspect nginxconfig </span>
<span class="token punctuation">[</span> 
    <span class="token punctuation">{</span> <span class="token string">&quot;CreatedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-13T17:23:00+08:00&quot;</span>, 
    <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>, 
    <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> null, 
    <span class="token string">&quot;Mountpoint&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/volumes/nginxconfig/_data&quot;</span>, 
    <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;nginxconfig&quot;</span>, 
    <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> null, 
    <span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">]</span>

<span class="token comment"># 怎么判断挂载的是卷名而不是本机目录名？ 不是/开始就是卷名，是/开始就是目录名 </span>
<span class="token comment"># 改变文件的读写权限 </span>
<span class="token comment"># ro: readonly </span>
<span class="token comment"># rw: readwrite </span>
<span class="token comment"># 指定容器对我们挂载出来的内容的读写权限 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> nginxconfig:/etc/nginx:ro nginx 
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> nginxconfig:/etc/nginx:rw nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="数据卷容器"><a href="#数据卷容器" class="header-anchor">#</a> 数据卷容器</h2> <blockquote><p>命名的容器挂载数据卷，其他容器通过挂载这个（父容器）实现数据共享，挂载数据卷的容器，称之为
数据卷容器。<br>
我们使用上一步的镜像：kuangshen/centos 为模板，运行容器 docker01，docker02，docker03，他<br>
们都会具有容器卷</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;/dataVolumeContainer1&quot; 
&quot;/dataVolumeContainer2&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>我们来测试下，容器间传递共享</p> <h3 id="_1-、先启动一个父容器docker01-然后在datavolumecontainer2新增文件"><a href="#_1-、先启动一个父容器docker01-然后在datavolumecontainer2新增文件" class="header-anchor">#</a> 1 、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720092847.png" alt="img"></p> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720092859.png" alt="img"></p> <h3 id="退出不停止-ctrl-p-q"><a href="#退出不停止-ctrl-p-q" class="header-anchor">#</a> 退出不停止：ctrl+P+Q</h3> <h3 id="_2-、创建docker02-docker03-让他们继承docker01-volumes-from"><a href="#_2-、创建docker02-docker03-让他们继承docker01-volumes-from" class="header-anchor">#</a> 2 、创建docker02，docker03 让他们继承docker01 --volumes-from</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker run -it --name docker02 --volumes-from docker01 kuangshen/centos</span>
<span class="token punctuation">[</span>root@ea4c82779077 /<span class="token punctuation">]</span><span class="token comment"># cd /dataVolumeContainer2</span>
<span class="token punctuation">[</span>root@ea4c82779077 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls</span>
docker01.txt
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># touch docker02.txt</span>
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls</span>
docker01.txt docker02.txt

<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker run -it --name docker03 --volumes-from docker01 kuangshen/centos</span>
<span class="token punctuation">[</span>root@ea4c82779077 /<span class="token punctuation">]</span><span class="token comment"># cd /dataVolumeContainer2</span>
<span class="token punctuation">[</span>root@ea4c82779077 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls</span>
docker01.txt docker02.txt
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># touch docker03.txt</span>
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls</span>
docker01.txt docker02.txt docker03.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_3-、回到docker01发现可以看到-02-和-03-添加的共享文件"><a href="#_3-、回到docker01发现可以看到-02-和-03-添加的共享文件" class="header-anchor">#</a> 3 、回到docker01发现可以看到 02 和 03 添加的共享文件</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker attach docker01</span>
<span class="token punctuation">[</span>root@799b6ea5db7c dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :20 docker01.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :22 docker02.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :24 docker03.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_4-、删除docker01-docker02-修改后docker03还能不能访问"><a href="#_4-、删除docker01-docker02-修改后docker03还能不能访问" class="header-anchor">#</a> 4 、删除docker01，docker02 修改后docker03还能不能访问</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker rm -f docker01</span>
docker01
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker attach docker02</span>
<span class="token punctuation">[</span>root@ea4c82779077 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :20 docker01.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :22 docker02.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :24 docker03.txt
<span class="token punctuation">[</span>root@ea4c82779077 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># touch docker02-update.txt</span>
<span class="token punctuation">[</span>root@ea4c82779077 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -a</span>
<span class="token builtin class-name">.</span> <span class="token punctuation">..</span> docker01.txt docker02.txt docker02-update.txt docker03.txt
<span class="token punctuation">[</span>root@ea4c82779077 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># Ctrl+P+Q 退出容器</span>
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker attach docker03</span>
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :20 docker01.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :22 docker02.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :29 docker02-update.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :24 docker03.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_5-、删除docker02-docker03还能不能访问"><a href="#_5-、删除docker02-docker03还能不能访问" class="header-anchor">#</a> 5 、删除docker02 ，docker03还能不能访问</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID IMAGE
95164598b306 kuangshen/centos
ea4c82779077 kuangshen/centos
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker rm -f docker02</span>
docker02
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker attach docker03</span>
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :20 docker01.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :22 docker02.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :29 docker02-update.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :24 docker03.txt
<span class="token punctuation">[</span>root@95164598b306 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># touch docker03-update.txt</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_6-、新建docker04继承docker03-然后再删除docker03-看下是否可以访问"><a href="#_6-、新建docker04继承docker03-然后再删除docker03-看下是否可以访问" class="header-anchor">#</a> 6 、新建docker04继承docker03，然后再删除docker03，看下是否可以访问！</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720093327.png" alt="img"></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@2119f4f23a92 /<span class="token punctuation">]</span><span class="token comment"># cd dataVolumeContainer2</span>
<span class="token punctuation">[</span>root@2119f4f23a92 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :20 docker01.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :22 docker02.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :29 docker02-update.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :32 docker03-update.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :24 docker03.txt

<span class="token comment"># 查看当前运行的容器</span>
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID IMAGE NAMES
2119f4f23a92 kuangshen/centos docker04
95164598b306 kuangshen/centos docker03

<span class="token comment"># 继续删除docker03</span>
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker rm -f docker03</span>
docker03
<span class="token punctuation">[</span>root@kuangshen docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker attach docker04</span>
<span class="token punctuation">[</span>root@2119f4f23a92 dataVolumeContainer2<span class="token punctuation">]</span><span class="token comment"># ls -l</span>
total <span class="token number">0</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :20 docker01.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :22 docker02.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :29 docker02-update.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :32 docker03-update.txt
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">11</span> <span class="token number">13</span> :24 docker03.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="得出结论"><a href="#得出结论" class="header-anchor">#</a> 得出结论：</h3> <blockquote><p>容器之间配置信息的传递，数据卷的生命周期一直持续到没有容器使用它为止。<br>
存储在本机的文件则会一直保留！</p></blockquote> <h1 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> DockerFile</h1> <blockquote><p>大家想想，Nginx，tomcat，mysql 这些镜像都是哪里来的？官方能写，我们不能写吗？<br>
我们要研究自己如何做一个镜像，而且我们写的微服务项目以及springboot打包上云部署，Docker就是<br>
最方便的。<br>
微服务打包成镜像，任何装了Docker的地方，都可以下载使用，极其的方便。<br>
流程：开发应用=&gt;DockerFile=&gt;打包为镜像=&gt;上传到仓库（私有仓库，公有仓库）=&gt; 下载镜像 =&gt; 启动<br>
运行。<br>
还可以方便移植！<br></p></blockquote> <h2 id="什么是dockerfile"><a href="#什么是dockerfile" class="header-anchor">#</a> 什么是DockerFile</h2> <p>dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本。<br>
构建步骤：<br></p> <ul><li>1、编写DockerFile文件</li> <li>2、docker build 构建镜像</li> <li>3、docker run
dockerfile文件我们刚才已经编写过了一次，这里我们继续使用 centos 来看！<br>
地址：https://hub.docker.com/_/centos<br> <img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720094253.png" alt="img"></li></ul> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720094323.png" alt="img"></p> <h2 id="dockerfile构建过程"><a href="#dockerfile构建过程" class="header-anchor">#</a> DockerFile构建过程</h2> <h3 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识：</h3> <ul><li>1、每条保留字指令都必须为大写字母且后面要跟随至少一个参数</li> <li>2、指令按照从上到下，顺序执行</li> <li>3、# 表示注释</li> <li>4、每条指令都会创建一个新的镜像层，并对镜像进行提交</li></ul> <h3 id="流程"><a href="#流程" class="header-anchor">#</a> 流程：</h3> <ul><li>1、docker从基础镜像运行一个容器</li> <li>2、执行一条指令并对容器做出修改</li> <li>3、执行类似 docker commit 的操作提交一个新的镜像层</li> <li>4、Docker再基于刚提交的镜像运行一个新容器</li> <li>5、执行dockerfile中的下一条指令直到所有指令都执行完成！</li></ul> <h3 id="说明"><a href="#说明" class="header-anchor">#</a> 说明：</h3> <blockquote><p>从应用软件的角度来看，DockerFile，docker镜像与docker容器分别代表软件的三个不同阶段。<br></p></blockquote> <ul><li>DockerFile 是软件的原材料 （代码）<br></li> <li>Docker 镜像则是软件的交付品 （.apk）<br></li> <li>Docker 容器则是软件的运行状态 （客户下载安装执行）<br>
DockerFile 面向开发，Docker镜像成为交付标准，Docker容器则涉及部署与运维，三者缺一不可！<br></li></ul> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720094815.png" alt="img"></p> <blockquote><p>DockerFile：需要定义一个DockerFile，DockerFile定义了进程需要的一切东西。DockerFile涉及的内容<br>
包括执行代码或者是文件、环境变量、依赖包、运行时环境、动态链接库、操作系统的发行版、服务进<br>
程和内核进程（当引用进行需要和系统服务和内核进程打交道，这时需要考虑如何设计 namespace的权<br>
限控制）等等。<br>
Docker镜像：在DockerFile 定义了一个文件之后，Docker build 时会产生一个Docker镜像，当运行<br>
Docker 镜像时，会真正开始提供服务；<br>
Docker容器：容器是直接提供服务的。<br></p></blockquote> <h2 id="dockerfile指令"><a href="#dockerfile指令" class="header-anchor">#</a> DockerFile指令</h2> <h3 id="关键字"><a href="#关键字" class="header-anchor">#</a> 关键字：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>FROM # 基础镜像，当前新镜像是基于哪个镜像的
MAINTAINER # 镜像维护者的姓名混合邮箱地址
RUN  # 容器构建时需要运行的命令
EXPOSE # 当前容器对外保留出的端口
WORKDIR  # 指定在创建容器后，终端默认登录的进来工作目录，一个落脚点
ENV  # 用来在构建镜像过程中设置环境变量
ADD  # 将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar压缩包
COPY # 类似ADD，拷贝文件和目录到镜像中！
VOLUME # 容器数据卷，用于数据保存和持久化工作
CMD  # 指定一个容器启动时要运行的命令，dockerFile中可以有多个CMD指令，但只有最后一个生效！
ENTRYPOINT # 指定一个容器启动时要运行的命令！和CMD一样
ONBUILD  # 当构建一个被继承的DockerFile时运行命令，父镜像在被子镜像继承后，父镜像的
ONBUILD被触发
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720095101.png" alt="img"></p> <h2 id="实战测试"><a href="#实战测试" class="header-anchor">#</a> 实战测试</h2> <p>Docker Hub 中99% 的镜像都是通过在base镜像（Scratch）中安装和配置需要的软件构建出来的</p> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720095139.png" alt="img"></p> <h3 id="自定义一个-centos"><a href="#自定义一个-centos" class="header-anchor">#</a> 自定义一个 centos</h3> <h3 id="_1-、编写dockerfile"><a href="#_1-、编写dockerfile" class="header-anchor">#</a> 1 、编写DockerFile</h3> <h3 id="查看下官方默认的centos的情况"><a href="#查看下官方默认的centos的情况" class="header-anchor">#</a> 查看下官方默认的CentOS的情况：</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720095244.png" alt="img"></p> <h3 id="目的-使我们自己的镜像具备如下-登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持"><a href="#目的-使我们自己的镜像具备如下-登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持" class="header-anchor">#</a> 目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持</h3> <h3 id="准备编写dockerflie文件"><a href="#准备编写dockerflie文件" class="header-anchor">#</a> 准备编写DockerFlie文件</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@kuangshen home]# mkdir dockerfile-test
[root@kuangshen home]# ls
ceshi dockerfile-test docker-test-volume f1
[root@kuangshen home]#
[root@kuangshen home]# vim mydockerfile-centos # 编辑文件
[root@kuangshen home]# cat mydockerfile-centos
FROM centos
MAINTAINER kuangshen&lt;24736743@qq.com&gt;

ENV MYPATH /usr/local
WORKDIR $MYPATH

RUN yum -y install vim
RUN yum -y install net-tools

EXPOSE 80 

CMD echo $MYPATH 
CMD echo &quot;----------end--------&quot; 
CMD /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_2-、构建"><a href="#_2-、构建" class="header-anchor">#</a> 2 、构建</h3> <p>docker build -f dockerfile地址 - t 新镜像名字:TAG.</p> <p>会看到 docker build 命令最后有一个.. 表示当前目录****</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker build -f mydockerfile-centos -t mycentos:0.1</span>
Sending build context to Docker daemon <span class="token number">6</span> .144kB
Step <span class="token number">1</span> /10 <span class="token builtin class-name">:</span> FROM centos
---<span class="token operator">&gt;</span> 470671670cac
Step <span class="token number">2</span> /10 <span class="token builtin class-name">:</span> MAINTAINER kuangshen<span class="token operator">&lt;</span><span class="token number">24736743</span>@qq.com<span class="token operator">&gt;</span>
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> ac052943c151
Removing intermediate container ac052943c151
---<span class="token operator">&gt;</span> 9d37c7174860
Step <span class="token number">3</span> /10 <span class="token builtin class-name">:</span> ENV MYPATH /usr/local
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> a9d43e0b41bb
Removing intermediate container a9d43e0b41bb
---<span class="token operator">&gt;</span> 7a89b945c3a6
Step <span class="token number">4</span> /10 <span class="token builtin class-name">:</span> WORKDIR <span class="token variable">$MYPATH</span>
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> b41f085b06bc
Removing intermediate container b41f085b06bc
---<span class="token operator">&gt;</span> 022384682f07
Step <span class="token number">5</span> /10 <span class="token builtin class-name">:</span> RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 8a8d351ee43b
CentOS-8 - AppStream <span class="token number">2</span> .7 MB/s <span class="token operator">|</span> <span class="token number">7</span> .0 MB 00 :02

CentOS-8 - Base <span class="token number">1</span> .1 MB/s <span class="token operator">|</span> <span class="token number">2</span> .2 MB 00 :02

CentOS-8 - Extras <span class="token number">6</span> .3 kB/s <span class="token operator">|</span> <span class="token number">5</span> .9 kB 00 :00

Dependencies resolved.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Package Arch Version Repository
Size
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Installing:
vim-enhanced x86_64 <span class="token number">2</span> :8.0.1763-13.el8 AppStream
 <span class="token number">1</span> .4 M
Installing dependencies:
gpm-libs x86_64 <span class="token number">1</span> .20.7-15.el8 AppStream
<span class="token number">39</span> k
vim-common x86_64 <span class="token number">2</span> :8.0.1763-13.el8 AppStream
 <span class="token number">6</span> .3 M
vim-filesystem noarch <span class="token number">2</span> :8.0.1763-13.el8 AppStream
<span class="token number">48</span> k
<span class="token function">which</span> x86_64 <span class="token number">2</span> .21-10.el8 BaseOS
 <span class="token number">49</span> k

Transaction Summary
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Install <span class="token number">5</span> Packages

Total download size: <span class="token number">7</span> .8 M
Installed size: <span class="token number">31</span> M
Downloading Packages:
<span class="token punctuation">(</span><span class="token number">1</span>/5<span class="token punctuation">)</span>: gpm-libs-1.20.7-15.el8.x86_64.rpm <span class="token number">815</span> kB/s <span class="token operator">|</span> <span class="token number">39</span> kB 00 :00

<span class="token punctuation">(</span><span class="token number">2</span>/5<span class="token punctuation">)</span>: vim-filesystem-8.0.1763-13.el8.noarch.rp <span class="token number">2</span> .1 MB/s <span class="token operator">|</span> <span class="token number">48</span> kB 00 :00

<span class="token punctuation">(</span><span class="token number">3</span>/5<span class="token punctuation">)</span>: which-2.21-10.el8.x86_64.rpm <span class="token number">161</span> kB/s <span class="token operator">|</span> <span class="token number">49</span> kB 00 :00

<span class="token punctuation">(</span><span class="token number">4</span>/5<span class="token punctuation">)</span>: vim-enhanced-8.0.1763-13.el8.x86_64.rpm <span class="token number">3</span> .1 MB/s <span class="token operator">|</span> <span class="token number">1</span> .4 MB 00 :00

<span class="token punctuation">(</span><span class="token number">5</span>/5<span class="token punctuation">)</span>: vim-common-8.0.1763-13.el8.x86_64.rpm <span class="token number">1</span> .4 MB/s <span class="token operator">|</span> <span class="token number">6</span> .3 MB 00 :04

---------------------------------------------------------------------------
-----
Total <span class="token number">1</span> .4 MB/s <span class="token operator">|</span> <span class="token number">7</span> .8 MB 00 :05

warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-
<span class="token number">1.20</span>.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d:
NOKEY
CentOS-8 - AppStream <span class="token number">786</span> kB/s <span class="token operator">|</span> <span class="token number">1</span> .6 kB 00 :00

Importing GPG key 0x8483C65D:
Userid <span class="token builtin class-name">:</span> <span class="token string">&quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;</span>
Fingerprint: 99DB 70FA E1D7 CE22 7FB6 <span class="token number">4882</span> 05B5 55B3 <span class="token number">8483</span> C65D
From <span class="token builtin class-name">:</span> /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
Key imported successfully
Running transaction check
Transaction check succeeded.
Running transaction <span class="token builtin class-name">test</span>
Transaction <span class="token builtin class-name">test</span> succeeded.
Running transaction
Preparing <span class="token builtin class-name">:</span>
 <span class="token number">1</span> /1
Installing <span class="token builtin class-name">:</span> which-2.21-10.el8.x86_64
<span class="token number">1</span> /5
Installing <span class="token builtin class-name">:</span> vim-filesystem-2:8.0.1763-13.el8.noarch
 <span class="token number">2</span> /5
Installing <span class="token builtin class-name">:</span> vim-common-2:8.0.1763-13.el8.x86_64
 <span class="token number">3</span> /5
Installing <span class="token builtin class-name">:</span> gpm-libs-1.20.7-15.el8.x86_64
 <span class="token number">4</span> /5
Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64
 <span class="token number">4</span> /5
Installing <span class="token builtin class-name">:</span> vim-enhanced-2:8.0.1763-13.el8.x86_64
 <span class="token number">5</span> /5
Running scriptlet: vim-enhanced-2:8.0.1763-13.el8.x86_64
 <span class="token number">5</span> /5
Running scriptlet: vim-common-2:8.0.1763-13.el8.x86_64
 <span class="token number">5</span> /5
Verifying <span class="token builtin class-name">:</span> gpm-libs-1.20.7-15.el8.x86_64
 <span class="token number">1</span> /5

Verifying <span class="token builtin class-name">:</span> vim-common-2:8.0.1763-13.el8.x86_64
 <span class="token number">2</span> /5
Verifying <span class="token builtin class-name">:</span> vim-enhanced-2:8.0.1763-13.el8.x86_64
 <span class="token number">3</span> /5
Verifying <span class="token builtin class-name">:</span> vim-filesystem-2:8.0.1763-13.el8.noarch
 <span class="token number">4</span> /5
Verifying <span class="token builtin class-name">:</span> which-2.21-10.el8.x86_64
<span class="token number">5</span> /5

Installed:
vim-enhanced-2:8.0.1763-13.el8.x86_64 gpm-libs-1.20.7-15.el8.x86_64

vim-common-2:8.0.1763-13.el8.x86_64 vim-filesystem-2:8.0.1763-
<span class="token number">13</span>.el8.noarch
which-2.21-10.el8.x86_64

Complete<span class="token operator">!</span>
Removing intermediate container 8a8d351ee43b
---<span class="token operator">&gt;</span> 6f6449a55974
Step <span class="token number">6</span> /10 <span class="token builtin class-name">:</span> RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> net-tools
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 4f2c187b0bed
Last metadata expiration check: <span class="token number">0</span> :00:12 ago on Tue May <span class="token number">12</span> 03 :07:25 <span class="token number">2020</span>.
Dependencies resolved.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Package Architecture Version Repository
Size
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Installing:
net-tools x86_64 <span class="token number">2</span> .0-0.51.20160912git.el8 BaseOS
<span class="token number">323</span> k

Transaction Summary
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Install <span class="token number">1</span> Package

Total download size: <span class="token number">323</span> k
Installed size: <span class="token number">1</span> .0 M
Downloading Packages:
net-tools-2.0-0.51.20160912git.el8.x86_64.rpm <span class="token number">1</span> .3 MB/s <span class="token operator">|</span> <span class="token number">323</span> kB 00 :00

---------------------------------------------------------------------------
-----
Total <span class="token number">397</span> kB/s <span class="token operator">|</span> <span class="token number">323</span> kB 00 :00

Running transaction check
Transaction check succeeded.
Running transaction <span class="token builtin class-name">test</span>
Transaction <span class="token builtin class-name">test</span> succeeded.
Running transaction
Preparing <span class="token builtin class-name">:</span>
 <span class="token number">1</span> /1
Installing <span class="token builtin class-name">:</span> net-tools-2.0-0.51.20160912git.el8.x86_64
 <span class="token number">1</span> /1
Running scriptlet: net-tools-2.0-0.51.20160912git.el8.x86_64
 <span class="token number">1</span> /1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br></div></div><h3 id="_3-、运行"><a href="#_3-、运行" class="header-anchor">#</a> 3 、运行</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -it 新镜像名字:TAG
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720100037.png" alt="img"></p> <h3 id="可以看到-我们自己的新镜像已经支持-vim-ifconfig的命令-扩展ok"><a href="#可以看到-我们自己的新镜像已经支持-vim-ifconfig的命令-扩展ok" class="header-anchor">#</a> 可以看到，我们自己的新镜像已经支持 vim/ifconfig的命令，扩展OK！</h3> <h3 id="_4-、列出镜像地的变更历史"><a href="#_4-、列出镜像地的变更历史" class="header-anchor">#</a> 4 、列出镜像地的变更历史</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker history 镜像名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720100126.png" alt="img"></p> <h3 id="cmd-和-entrypoint-的区别"><a href="#cmd-和-entrypoint-的区别" class="header-anchor">#</a> CMD 和 ENTRYPOINT 的区别</h3> <p>我们之前说过，两个命令都是指定一个容器启动时要运行的命令<br>
CMD：Dockerfile 中可以有多个CMD 指令，但只有最后一个生效，CMD 会被 docker run 之后的参数<br>
替换！<br>
ENTRYPOINT： docker run 之后的参数会被当做参数传递给 ENTRYPOINT，之后形成新的命令组合！<br>
测试<br></p> <h3 id="cmd命令"><a href="#cmd命令" class="header-anchor">#</a> CMD命令</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1、构建dockerfile</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-cmd-test</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># cat dockerfile-cmd-test</span>
FROM centos
CMD <span class="token punctuation">[</span> <span class="token string">&quot;ls&quot;</span>, <span class="token string">&quot;-a&quot;</span> <span class="token punctuation">]</span>

<span class="token comment"># 2、build 镜像</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker build -f dockerfile-cmd-test -t cmdtest.</span>
Sending build context to Docker daemon <span class="token number">22</span> .02kB
Step <span class="token number">1</span> /2 <span class="token builtin class-name">:</span> FROM centos
---<span class="token operator">&gt;</span> 470671670cac
Step <span class="token number">2</span> /2 <span class="token builtin class-name">:</span> CMD <span class="token punctuation">[</span> <span class="token string">&quot;ls&quot;</span>, <span class="token string">&quot;-a&quot;</span> <span class="token punctuation">]</span>
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> a3072987de38
Removing intermediate container a3072987de38
---<span class="token operator">&gt;</span> 554bc6952657
Successfully built 554bc6952657
Successfully tagged cmdtest:latest

<span class="token comment"># 3、执行</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker run 554bc6952657</span>
.dockerenv
bin
dev
etc
home
lib
lib64
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token comment"># 4、如果我们希望用 -l 列表展示信息，我们就需要加上 -l参数</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker run cmdtest -l</span>
docker: Error response from daemon: OCI runtime create failed:
container_linux.go:349: starting container process caused <span class="token string">&quot;exec: <span class="token entity" title="\&quot;">\&quot;</span>-l<span class="token entity" title="\&quot;">\&quot;</span>:
executable file not found in <span class="token environment constant">$PATH</span>&quot;</span><span class="token builtin class-name">:</span> unknown.

<span class="token comment"># 问题：我们可以看到可执行文件找不到的报错，executable file not found。</span>
<span class="token comment"># 之前我们说过，跟在镜像名后面的是 command，运行时会替换 CMD 的默认值。</span>
<span class="token comment"># 因此这里的 -l 替换了原来的 CMD，而不是添加在原来的 ls -a 后面。而 -l 根本不是命令，所</span>
以自然找不到。
<span class="token comment"># 那么如果我们希望加入 -l 这参数，我们就必须重新完整的输入这个命令：</span>

<span class="token function">docker</span> run cmdtest <span class="token function">ls</span> <span class="token parameter variable">-al</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="entrypoint命令"><a href="#entrypoint命令" class="header-anchor">#</a> ENTRYPOINT命令</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1、构建dockerfile</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-entrypoint-test</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># cat dockerfile-entrypoint-test</span>
FROM centos
ENTRYPOINT <span class="token punctuation">[</span> <span class="token string">&quot;ls&quot;</span>, <span class="token string">&quot;-a&quot;</span> <span class="token punctuation">]</span>

<span class="token comment"># 2、build 镜像</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker build -f dockerfile-entrypoint-test -t</span>
entrypointtest.
Sending build context to Docker daemon <span class="token number">23</span> .04kB
Step <span class="token number">1</span> /2 <span class="token builtin class-name">:</span> FROM centos
---<span class="token operator">&gt;</span> 470671670cac
Step <span class="token number">2</span> /2 <span class="token builtin class-name">:</span> ENTRYPOINT <span class="token punctuation">[</span> <span class="token string">&quot;ls&quot;</span>, <span class="token string">&quot;-a&quot;</span> <span class="token punctuation">]</span>
---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> bac4ae055630
Removing intermediate container bac4ae055630
---<span class="token operator">&gt;</span> ae07199f9144
Successfully built ae07199f9144
Successfully tagged entrypointtest:latest

<span class="token comment"># 3、执行</span>
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker run ae07199f9144</span>
.dockerenv
bin
dev
etc
home
lib
lib64
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token comment"># 4、测试-l参数，发现可以直接使用，这里就是一种追加，我们可以明显的知道 CMD 和</span>
ENTRYPOINT 的区别了
<span class="token punctuation">[</span>root@kuangshen home<span class="token punctuation">]</span><span class="token comment"># docker run entrypointtest -l</span>
total <span class="token number">56</span>
drwxr-xr-x <span class="token number">1</span> root root <span class="token number">4096</span> May <span class="token number">12</span> 04 :21.
drwxr-xr-x <span class="token number">1</span> root root <span class="token number">4096</span> May <span class="token number">12</span> 04 :21 <span class="token punctuation">..</span>
-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">12</span> 04 :21 .dockerenv
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">7</span> May <span class="token number">11</span>  <span class="token number">2019</span> bin -<span class="token operator">&gt;</span> usr/bin
drwxr-xr-x <span class="token number">5</span> root root <span class="token number">340</span> May <span class="token number">12</span> 04 :21 dev
drwxr-xr-x <span class="token number">1</span> root root <span class="token number">4096</span> May <span class="token number">12</span> 04 :21 etc
drwxr-xr-x <span class="token number">2</span> root root <span class="token number">4096</span> May <span class="token number">11</span>  <span class="token number">2019</span> home
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="自定义镜像-tomcat"><a href="#自定义镜像-tomcat" class="header-anchor">#</a> 自定义镜像 tomcat</h3> <ul><li>1、 mkdir -p kuangshen/build/tomcat</li> <li>2、在上述目录下 touch read.txt</li> <li>3、将 JDK 和 tomcat 安装的压缩包拷贝进上一步目录</li> <li>4、在 /kuangshen/build/tomcat 目录下新建一个Dockerfile文件</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># vim Dockerfile</span>

FROM centos
MAINTAINER kuangshen<span class="token operator">&lt;</span><span class="token number">24736743</span>@qq.com<span class="token operator">&gt;</span>
<span class="token comment">#把宿主机当前上下文的read.txt拷贝到容器/usr/local/路径下</span>
COPY read.txt /usr/local/cincontainer.txt
<span class="token comment">#把java与tomcat添加到容器中</span>
ADD jdk-8u11-linux-x64.tar.gz /usr/local/
ADD apache-tomcat-9.0.22.tar.gz /usr/local/
<span class="token comment">#安装vim编辑器</span>
RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
<span class="token comment">#设置工作访问时候的WORKDIR路径，登录落脚点</span>
ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>
<span class="token comment">#配置java与tomcat环境变量</span>
ENV JAVA_HOME /usr/local/jdk1.8.0_11
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.22
ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.22
ENV <span class="token environment constant">PATH</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$CATALINA_HOME</span>/lib:<span class="token variable">$CATALINA_HOME</span>/bin
<span class="token comment">#容器运行时监听的端口</span>
EXPOSE <span class="token number">8080</span>
<span class="token comment">#启动时运行tomcat</span>
<span class="token comment"># ENTRYPOINT [&quot;/usr/local/apache-tomcat-9.0.22/bin/startup.sh&quot; ]</span>
<span class="token comment"># CMD [&quot;/usr/local/apache-tomcat-9.0.22/bin/catalina.sh&quot;,&quot;run&quot;]</span>
CMD /usr/local/apache-tomcat-9.0.22/bin/startup.sh <span class="token operator">&amp;&amp;</span> <span class="token function">tail</span> <span class="token parameter variable">-F</span>
/usr/local/apache-tomcat-9.0.22/bin/logs/catalina.out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="当前文件状态"><a href="#当前文件状态" class="header-anchor">#</a> 当前文件状态</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101049.png" alt="img"></p> <h3 id="_5-、构建镜像"><a href="#_5-、构建镜像" class="header-anchor">#</a> 5 、构建镜像</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker build -t diytomcat.</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
Successfully built ffdf6529937d
Successfully tagged diytomcat:latest  <span class="token comment"># 构建完成</span>

<span class="token comment"># 查看确定构建完毕！</span>
<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY TAG IMAGE ID CREATED
SIZE
diytomcat latest ffdf6529937d <span class="token number">20</span> seconds ago
636MB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_6-、运行启动-run"><a href="#_6-、运行启动-run" class="header-anchor">#</a> 6 、运行启动 run</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -d -p 9090 :8080 --name mydiytomcat -v /home/kuangshen/build/tomcat/test:/usr/local/apache-tomcat-9.0.22/webapps/test -v /home/kuangshen/build/tomcat/tomcat9logs/:/usr/local/apache-tomcat-9.0.22/logs --privileged=true diytomcat
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101217.png" alt="img"></p> <blockquote><p>备注：Docker挂载主机目录Docker访问出现cannot open directory .: Permission denied<br>
解决办法：在挂载目录后多加一个--privileged=true参数即可</p></blockquote> <h3 id="_7-、验证测试访问-curl-localhost-9090"><a href="#_7-、验证测试访问-curl-localhost-9090" class="header-anchor">#</a> 7 、验证测试访问！ curl localhost:9090</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101259.png" alt="img"></p> <h3 id="_8-、结合前面学习的容器卷将测试的web服务test发布"><a href="#_8-、结合前面学习的容器卷将测试的web服务test发布" class="header-anchor">#</a> 8 、结合前面学习的容器卷将测试的web服务test发布</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101311.png" alt="img"></p> <h3 id="web-xml"><a href="#web-xml" class="header-anchor">#</a> web.xml</h3> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/javaee<span class="token punctuation">&quot;</span></span>
<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>WebApp_ID<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.5<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display-name</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>display-name</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="a-jsp"><a href="#a-jsp" class="header-anchor">#</a> a.jsp</h3> <div class="language-jsp line-numbers-mode"><pre class="language-text"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
&quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;hello，kuangshen&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
-----------welcome------------
&lt;%=&quot; my docker tomcat，kuangshen666 &quot;%&gt;
&lt;br&gt;
&lt;br&gt;
&lt;% System.out.println(&quot;-------my docker tomcat-------&quot;);%&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_9-、测试"><a href="#_9-、测试" class="header-anchor">#</a> 9 、测试</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101427.png" alt="img"></p> <h4 id="查看日志-2"><a href="#查看日志-2" class="header-anchor">#</a> # 查看日志</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># cd tomcat9logs/</span>
<span class="token punctuation">[</span>root@kuangshen tomcat9logs<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">24</span>
-rw-r----- <span class="token number">1</span> root root <span class="token number">6993</span> May <span class="token number">12</span> <span class="token number">12</span> :50 catalina.2020-05-12.log
-rw-r----- <span class="token number">1</span> root root <span class="token number">7024</span> May <span class="token number">12</span> <span class="token number">12</span> :53 catalina.out
-rw-r----- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">12</span> <span class="token number">12</span> :47 host-manager.2020-05-12.log
-rw-r----- <span class="token number">1</span> root root <span class="token number">408</span> May <span class="token number">12</span> <span class="token number">12</span> :47 localhost.2020-05-12.log
-rw-r----- <span class="token number">1</span> root root <span class="token number">150</span> May <span class="token number">12</span> <span class="token number">12</span> :53 localhost_access_log.2020-05-12.txt
-rw-r----- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">12</span> <span class="token number">12</span> :47 manager.2020-05-12.log
<span class="token punctuation">[</span>root@kuangshen tomcat9logs<span class="token punctuation">]</span><span class="token comment"># cat catalina.out</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>
-------my <span class="token function">docker</span> tomcat-------  <span class="token comment"># 搞定</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="发布镜像"><a href="#发布镜像" class="header-anchor">#</a> 发布镜像</h2> <h3 id="dockerhub"><a href="#dockerhub" class="header-anchor">#</a> DockerHub</h3> <h3 id="注册dockerhub-https-hub-docker-com-signup-需要有一个账号"><a href="#注册dockerhub-https-hub-docker-com-signup-需要有一个账号" class="header-anchor">#</a> 注册dockerhub https://hub.docker.com/signup，需要有一个账号</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1、查看登录命令</span>
<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker login --help</span>
Usage: <span class="token function">docker</span> login <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> <span class="token punctuation">[</span>SERVER<span class="token punctuation">]</span>
<span class="token comment"># 2、登录</span>
<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker login -u kuangshen</span>
Password:
WARNING<span class="token operator">!</span> Your password will be stored unencrypted <span class="token keyword">in</span>
/root/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/<span class="token comment">#credentials-</span>
store
Login Succeeded
<span class="token comment"># 3、将镜像发布出去</span>
<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker push kuangshen/diytomcat:1.0</span>
The push refers to repository <span class="token punctuation">[</span>docker.io/library/diytomcat<span class="token punctuation">]</span>
0f02399c6fdf: Preparing
e79ea0c3a34e: Preparing
09281fa8fe38: Preparing
b56a902b0aef: Preparing
0683de282177: Preparing
<span class="token comment"># 拒绝：请求的资源访问被拒绝</span>
denied: requested access to the resource is denied

<span class="token comment"># 问题：本地镜像名无帐号信息，解决加 tag即可</span>
<span class="token function">docker</span> tag 251ca4419332 kuangshen/diytomcat:1.0

<span class="token comment"># 再次 push， ok</span>
<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker push kuangshen/diytomcat:1.0</span>
The push refers to repository <span class="token punctuation">[</span>docker.io/kuangshen/diytomcat<span class="token punctuation">]</span>
0f02399c6fdf: Pushing <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token punctuation">]</span>
 <span class="token number">9</span> .729MB/59.76MB
e79ea0c3a34e: Pushing <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token punctuation">]</span>
 <span class="token number">3</span> .188MB/15.41MB
09281fa8fe38: Pushing <span class="token punctuation">[</span><span class="token operator">&gt;</span> <span class="token punctuation">]</span>
 <span class="token number">3</span> .823MB/324MB
b56a902b0aef: Pushed
0683de282177: Pushing <span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">]</span>
 <span class="token number">5</span> .997MB/237.1MB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="阿里云镜像服务"><a href="#阿里云镜像服务" class="header-anchor">#</a> 阿里云镜像服务</h3> <ul><li>1、登录阿里云</li> <li>2、找到容器镜像服务
<img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101724.png" alt="img"></li></ul> <h3 id="_3-、创建命名空间"><a href="#_3-、创建命名空间" class="header-anchor">#</a> 3 、创建命名空间</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101741.png" alt="img"></p> <h3 id="_4-、创建镜像仓库"><a href="#_4-、创建镜像仓库" class="header-anchor">#</a> 4 、创建镜像仓库</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101802.png" alt="img"></p> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101824.png" alt="img"></p> <h3 id="_5-、点击进入这个镜像仓库-可以看到所有的信息"><a href="#_5-、点击进入这个镜像仓库-可以看到所有的信息" class="header-anchor">#</a> 5 、点击进入这个镜像仓库，可以看到所有的信息</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101845.png" alt="img"></p> <h3 id="_6-、测试推送发布"><a href="#_6-、测试推送发布" class="header-anchor">#</a> 6 、测试推送发布</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker login --username=18225148644 registry.cn-beijing.aliyuncs.com</span>
Password:
WARNING<span class="token operator">!</span> Your password will be stored unencrypted <span class="token keyword">in</span>
/root/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/<span class="token comment">#credentials-</span>
store

Login Succeeded

<span class="token comment"># 2、设置 tag</span>
<span class="token function">docker</span> tag <span class="token punctuation">[</span>ImageId<span class="token punctuation">]</span> registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:<span class="token punctuation">[</span>镜像版本号<span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker tag 251ca4419332 registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:v1.0</span>

<span class="token comment"># 3、推送命令</span>
<span class="token function">docker</span> push registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:<span class="token punctuation">[</span>镜像版本号<span class="token punctuation">]</span>

<span class="token punctuation">[</span>root@kuangshen tomcat<span class="token punctuation">]</span><span class="token comment"># docker push registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:v1.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_7-、在阿里云镜像仓库查看效果"><a href="#_7-、在阿里云镜像仓库查看效果" class="header-anchor">#</a> 7 、在阿里云镜像仓库查看效果！</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720101953.png" alt="img"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720102036.png" alt="img"></p> <h1 id="docker-网络讲解"><a href="#docker-网络讲解" class="header-anchor">#</a> Docker-网络讲解</h1> <h2 id="理解docker0"><a href="#理解docker0" class="header-anchor">#</a> 理解Docker0</h2> <h3 id="准备工作-清空所有的容器-清空所有的镜像"><a href="#准备工作-清空所有的容器-清空所有的镜像" class="header-anchor">#</a> 准备工作：清空所有的容器，清空所有的镜像</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker rm -f $(docker ps -a -q) # 删除所有容器
docker rmi -f $(docker images -qa) # 删除全部镜像
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="docker的网络也是十分重要的一个点-希望大家可以认真理解"><a href="#docker的网络也是十分重要的一个点-希望大家可以认真理解" class="header-anchor">#</a> Docker的网络也是十分重要的一个点，希望大家可以认真理解！</h3> <h3 id="我们先来做个测试"><a href="#我们先来做个测试" class="header-anchor">#</a> 我们先来做个测试</h3> <h3 id="查看本地ip-ip-addr"><a href="#查看本地ip-ip-addr" class="header-anchor">#</a> 查看本地ip ip addr</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720102953.png" alt="img"></p> <h3 id="这里我们分析可得-有三个网络"><a href="#这里我们分析可得-有三个网络" class="header-anchor">#</a> 这里我们分析可得，有三个网络：</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>lo 127 .0.0.1 # 本机回环地址
eth0 172 .17.90.138 # 阿里云的私有IP
docker0 172 .18.0.1  # docker网桥
# 问题：Docker 是如何处理容器网络访问的？
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>我们之前安装ES的时候，留过一个问题，就是安装Kibana的问题，Kibana得指定ES的地址！或者我们<br>
实际场景中，我们开发了很多微服务项目，那些微服务项目都要连接数据库，需要指定数据库的url地<br>
址，通过ip。但是我们用Docker管理的话，假设数据库出问题了，我们重新启动运行一个，这个时候数<br>
据库的地址就会发生变化，docker会给每个容器都分配一个ip，且容器和容器之间是可以互相访问的。<br>
我们可以测试下容器之间能不能ping通过：<br></p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 启动tomcat01</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat01 tomcat</span>

<span class="token comment"># 查看tomcat01的ip地址，docker会给每个容器都分配一个ip！</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ip addr</span>
<span class="token number">1</span> <span class="token builtin class-name">:</span> lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group
default qlen <span class="token number">1000</span>
link/loopback 00 :00:00:00:00:00 brd 00 :00:00:00:00:00
inet <span class="token number">127</span> .0.0.1/8 scope <span class="token function">host</span> lo
valid_lft forever preferred_lft forever
<span class="token number">122</span> <span class="token builtin class-name">:</span> eth0@if123: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue
state UP group default
link/ether 02 :42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="token number">0</span>
inet <span class="token number">172</span> .18.0.2/16 brd <span class="token number">172</span> .18.255.255 scope global eth0
valid_lft forever preferred_lft forever

<span class="token comment"># 思考，我们的linux服务器是否可以ping通容器内的tomcat ？</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># ping 172.18.0.2</span>
PING <span class="token number">172</span> .18.0.2 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span> <span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">172</span> .18.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .070 ms  <span class="token comment"># 可以ping通！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <h3 id="_1-、每一个安装了docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡-使用了veth-pair技术"><a href="#_1-、每一个安装了docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡-使用了veth-pair技术" class="header-anchor">#</a> 1 、每一个安装了Docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡，使用了veth-pair技术！</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 我们再次查看主机的 ip addr</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># ip addr</span>
<span class="token number">1</span> <span class="token builtin class-name">:</span> lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group
default qlen <span class="token number">1000</span>
link/loopback 00 :00:00:00:00:00 brd 00 :00:00:00:00:00
inet <span class="token number">127</span> .0.0.1/8 scope <span class="token function">host</span> lo
valid_lft forever preferred_lft forever
<span class="token number">2</span> <span class="token builtin class-name">:</span> eth0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state
UP group default qlen <span class="token number">1000</span>
link/ether 00 :16:3e:30:27:f4 brd ff:ff:ff:ff:ff:ff
inet <span class="token number">172</span> .17.90.138/20 brd <span class="token number">172</span> .17.95.255 scope global dynamic eth0
valid_lft 310954997sec preferred_lft 310954997sec
<span class="token number">3</span> <span class="token builtin class-name">:</span> docker0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state
UP group default
link/ether 02 :42:bb:71:07:06 brd ff:ff:ff:ff:ff:ff
inet <span class="token number">172</span> .18.0.1/16 brd <span class="token number">172</span> .18.255.255 scope global docker0
valid_lft forever preferred_lft forever
<span class="token number">123</span> <span class="token builtin class-name">:</span> vethc8584ea@if122: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc
noqueue master docker0 state UP group default
link/ether 0a:4b:bb:40:78:a7 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="token number">0</span>
<span class="token comment"># 发现：本来我们有三个网络，我们在启动了个tomcat容器之后，多了一个！ 123 的网络！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_2-、每启动一个容器-linux主机就会多了一个虚拟网卡。"><a href="#_2-、每启动一个容器-linux主机就会多了一个虚拟网卡。" class="header-anchor">#</a> 2 、每启动一个容器，linux主机就会多了一个虚拟网卡。</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 我们启动了一个tomcat01，主机的ip地址多了一个 123: vethc8584ea@if122</span>
<span class="token comment"># 然后我们在tomcat01容器中查看容器的ip是 122: eth0@if123</span>

<span class="token comment"># 我们再启动一个tomcat02观察</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat02 tomcat</span>

<span class="token comment"># 然后发现linux主机上又多了一个网卡 125: veth021eeea@if124:</span>
<span class="token comment"># 我们看下tomcat02的容器内ip地址是 124: eth0@if125:</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ip addr</span>

<span class="token comment"># 观察现象：</span>
<span class="token comment"># tomcat --- linux主机 vethc8584ea@if122 ---- 容器内 eth0@if123</span>
<span class="token comment"># tomcat --- linux主机 veth021eeea@if124 ---- 容器内 eth0@if125</span>
<span class="token comment"># 相信到了这里，大家应该能看出点小猫腻了吧！只要启动一个容器，就有一对网卡</span>

<span class="token comment"># veth-pair 就是一对的虚拟设备接口，它都是成对出现的。一端连着协议栈，一端彼此相连着。</span>
<span class="token comment"># 正因为有这个特性，它常常充当着一个桥梁，连接着各种虚拟网络设备!</span>
<span class="token comment"># “Bridge、OVS 之间的连接”，“Docker 容器之间的连接” 等等，以此构建出非常复杂的虚拟网络结构，比如 OpenStack Neutron。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_3-、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通"><a href="#_3-、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通" class="header-anchor">#</a> 3 、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping 172.18.0.2</span>
PING <span class="token number">172</span> .18.0.2 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span> <span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">172</span> .18.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .110 ms
<span class="token comment"># 结论：容器和容器之间是可以互相访问的。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_4-、我们来画一个网络模型图"><a href="#_4-、我们来画一个网络模型图" class="header-anchor">#</a> 4 、我们来画一个网络模型图</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720103853.png" alt="img"></p> <blockquote><p>结论：tomcat1和tomcat2共用一个路由器。是的，他们使用的一个，就是docker0。任何一个容器启动<br>
默认都是docker0网络。<br>
docker默认会给容器分配一个可用ip。<br></p></blockquote> <h3 id="小结-3"><a href="#小结-3" class="header-anchor">#</a> 小结</h3> <blockquote><p>Docker使用Linux桥接，在宿主机虚拟一个Docker容器网桥(docker0)，Docker启动一个容器时会根据<br>
Docker网桥的网段分配给容器一个IP地址，称为Container-IP，同时Docker网桥是每个容器的默认网<br>
关。因为在同一宿主机内的容器都接入同一个网桥，这样容器之间就能够通过容器的Container-IP直接<br>
通信。<br></p></blockquote> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720104149.png" alt="img"></p> <blockquote><p>Docker容器网络就很好的利用了Linux虚拟网络技术，在本地主机和容器内分别创建一个虚拟接口，并<br>
让他们彼此联通（这样一对接口叫veth pair）；<br>
Docker中的网络接口默认都是虚拟的接口。虚拟接口的优势就是转发效率极高（因为Linux是在内核中<br>
进行数据的复制来实现虚拟接口之间的数据转发，无需通过外部的网络设备交换），对于本地系统和容<br>
器系统来说，虚拟接口跟一个正常的以太网卡相比并没有区别，只是他的速度快很多。<br></p></blockquote> <h2 id="link"><a href="#link" class="header-anchor">#</a> --Link</h2> <blockquote><p>思考一个场景，我们编写一个微服务，数据库连接地址原来是使用ip的，如果ip变化就不行了，那我们<br>
能不能使用服务名访问呢？<br><br>
jdbc:mysql://mysql:3306，这样的话哪怕mysql重启，我们也不需要修改配置了！docker提供了 --link<br>
的操作！<br></p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 我们使用tomcat02，直接通过容器名ping tomcat01，不使用ip</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping tomcat01</span>
ping: tomcat01: Name or <span class="token function">service</span> not known  <span class="token comment"># 发现ping不通</span>

<span class="token comment"># 我们再启动一个tomcat03，但是启动的时候连接tomcat02</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat03 --link tomcat02 tomcat</span>
a3a4a17a2b707766ad4f2bb967ce1d94f658cd4cccef3bb8707395cdc71fa1e7

<span class="token comment"># 这个时候，我们就可以使用tomcat03 ping通tomcat02 了</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat03 ping tomcat02</span>
PING tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span> <span class="token number">56</span> <span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .093 ms
<span class="token number">64</span> bytes from tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .066 ms

<span class="token comment"># 再来测试，tomcat03 是否可以ping tomcat01 失败</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat03 ping tomcat01</span>
ping: tomcat01: Name or <span class="token function">service</span> not known

<span class="token comment"># 再来测试，tomcat02 是否可以ping tomcat03 反向也ping不通</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping tomcat03</span>
ping: tomcat03: Name or <span class="token function">service</span> not known
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="思考-这个原理是什么呢-我们进入tomcat03中查看下host配置文件"><a href="#思考-这个原理是什么呢-我们进入tomcat03中查看下host配置文件" class="header-anchor">#</a> 思考，这个原理是什么呢？我们进入tomcat03中查看下host配置文件</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat03 cat /etc/hosts</span>
<span class="token number">127</span> .0.0.1 localhost
::1 localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
<span class="token number">172</span> .18.0.3 tomcat02 b80da266a3ad  <span class="token comment"># 发现tomcat2直接被写在这里</span>
<span class="token number">172</span> .18.0.4 a3a4a17a2b70

<span class="token comment"># 所以这里其实就是配置了一个 hosts 地址而已！</span>
<span class="token comment"># 原因：--link的时候，直接把需要link的主机的域名和ip直接配置到了hosts文件中了。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="link早都过时了-我们不推荐使用-我们可以使用自定义网络的方式"><a href="#link早都过时了-我们不推荐使用-我们可以使用自定义网络的方式" class="header-anchor">#</a> --link早都过时了，我们不推荐使用！我们可以使用自定义网络的方式</h5> <h2 id="自定义网络"><a href="#自定义网络" class="header-anchor">#</a> 自定义网络</h2> <h3 id="基本命令查看"><a href="#基本命令查看" class="header-anchor">#</a> 基本命令查看</h3> <h3 id="命令如下"><a href="#命令如下" class="header-anchor">#</a> 命令如下：</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720104443.png" alt="img"></p> <h3 id="查看所有网络"><a href="#查看所有网络" class="header-anchor">#</a> 查看所有网络</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@kuangshen ~]# docker network ls
NETWORK ID NAME DRIVER SCOPE
4eb2182ac4b2 bridge bridge local
ae2b6209c2ab host host local
c037f7ec7e57 none null local
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="网络模式"><a href="#网络模式" class="header-anchor">#</a> 网络模式</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720104548.png" alt="img"></p> <h3 id="查看一个具体的网络的详细信息"><a href="#查看一个具体的网络的详细信息" class="header-anchor">#</a> 查看一个具体的网络的详细信息</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 命令</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network inspect 4eb2182ac4b2</span>
<span class="token punctuation">[</span>
<span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bridge&quot;</span>,
<span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;4eb2182ac4b23487e1eb6e06df56c71ab6f0adc7ccc0962b4747d0eed5ad6690&quot;</span>,
<span class="token string">&quot;Created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-11T15:44:20.131441544+08:00&quot;</span>,
<span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
<span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bridge&quot;</span>,
<span class="token string">&quot;EnableIPv6&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;IPAM&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
<span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> null,
<span class="token string">&quot;Config&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
<span class="token punctuation">{</span>
// 默认docker0是管理这个子网范围内的。0~16，也就是 <span class="token number">255</span> *255，去
掉 <span class="token number">0</span> 个 <span class="token number">255</span> ，我们有 <span class="token number">65534</span> 可以分配的ip
// docker0网络默认可以支持创建 <span class="token number">6</span> 万多个容器ip不重复
<span class="token string">&quot;Subnet&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.18.0.0/16&quot;</span>,
<span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.18.0.1&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;Internal&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;Attachable&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;Ingress&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;ConfigFrom&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Network&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;ConfigOnly&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;Containers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;a3a4a17a2b707766ad4f2bb967ce1d94f658cd4cccef3bb8707395cdc71fa1e7&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat03&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;5fe62d0be3a1343aa74f6bb77885d3657b191210cafad200e5054e1bdfe56be9&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:12:00:04&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.18.0.4/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;b80da266a3ad85fcc874c5f0d3c897246ebc40533cb745bb24180237cc3167b1&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat02&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;6232cac0c4e7fed30c9fa5eebc9238f9fc44f548f257344b5440d6d486825256&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:12:00:03&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.18.0.3/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;f38239e2b405bccf8c93bd1052f336f661033b9b27ef9b3f99a018c108e06f87&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat01&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;31dc174b8f3f15f217acdc3ac7e8a235a03d59438f863706c0143b4426772c5e&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:12:00:02&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.18.0.2/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;com.docker.network.bridge.default_bridge&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
<span class="token string">&quot;com.docker.network.bridge.enable_icc&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
<span class="token string">&quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
<span class="token string">&quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0.0.0.0&quot;</span>,
<span class="token string">&quot;com.docker.network.bridge.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;docker0&quot;</span>,
<span class="token string">&quot;com.docker.network.driver.mtu&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1500&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h3 id="自定义网卡"><a href="#自定义网卡" class="header-anchor">#</a> 自定义网卡</h3> <h3 id="_1-、删除原来的所有容器"><a href="#_1-、删除原来的所有容器" class="header-anchor">#</a> 1 、删除原来的所有容器</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker rm -f $(docker ps -aq)</span>

<span class="token comment"># 恢复到了最开始的样子</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># ip addr</span>
<span class="token number">1</span> <span class="token builtin class-name">:</span> lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group
default qlen <span class="token number">1000</span>
link/loopback 00 :00:00:00:00:00 brd 00 :00:00:00:00:00
inet <span class="token number">127</span> .0.0.1/8 scope <span class="token function">host</span> lo
valid_lft forever preferred_lft forever
<span class="token number">2</span> <span class="token builtin class-name">:</span> eth0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state
UP group default qlen <span class="token number">1000</span>
link/ether 00 :16:3e:30:27:f4 brd ff:ff:ff:ff:ff:ff
inet <span class="token number">172</span> .17.90.138/20 brd <span class="token number">172</span> .17.95.255 scope global dynamic eth0
valid_lft 310951436sec preferred_lft 310951436sec
<span class="token number">3</span> <span class="token builtin class-name">:</span> docker0: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state
DOWN group default
link/ether 02 :42:bb:71:07:06 brd ff:ff:ff:ff:ff:ff
inet <span class="token number">172</span> .18.0.1/16 brd <span class="token number">172</span> .18.255.255 scope global docker0
valid_lft forever preferred_lft forever
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_2-、接下来我们来创建容器-但是我们知道默认创建的容器都是docker0网卡的"><a href="#_2-、接下来我们来创建容器-但是我们知道默认创建的容器都是docker0网卡的" class="header-anchor">#</a> 2 、接下来我们来创建容器，但是我们知道默认创建的容器都是docker0网卡的</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 默认我们不配置网络，也就相当于默认值 --net bridge 使用的docker0</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> tomcat01 <span class="token parameter variable">--net</span> bridge tomcat

<span class="token comment"># docker0网络的特点</span>
    <span class="token number">1</span> .它是默认的
    <span class="token number">2</span> .域名访问不通
    <span class="token number">3</span> .--link 域名通了，但是删了又不行
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_3-、我们可以让容器创建的时候使用自定义网络"><a href="#_3-、我们可以让容器创建的时候使用自定义网络" class="header-anchor">#</a> 3 、我们可以让容器创建的时候使用自定义网络</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720104920.png" alt="img"></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 自定义创建的默认default &quot;bridge&quot;</span>
<span class="token comment"># 自定义创建一个网络网络</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span>
09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236

<span class="token comment"># 确认下</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>
NETWORK ID NAME DRIVER SCOPE
4eb2182ac4b2 bridge bridge <span class="token builtin class-name">local</span>
ae2b6209c2ab <span class="token function">host</span> <span class="token function">host</span> <span class="token builtin class-name">local</span>
09bd09d8d3a6 mynet bridge <span class="token builtin class-name">local</span>
c037f7ec7e57 none null <span class="token builtin class-name">local</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network inspect mynet</span>
<span class="token punctuation">[</span>
<span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mynet&quot;</span>,
<span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236&quot;</span>,
<span class="token string">&quot;Created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-05-13T13:29:33.568644836+08:00&quot;</span>,
<span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
<span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bridge&quot;</span>,
<span class="token string">&quot;EnableIPv6&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;IPAM&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
<span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
<span class="token string">&quot;Config&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
<span class="token punctuation">{</span>
<span class="token string">&quot;Subnet&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.0/16&quot;</span>,
<span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.1&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;Internal&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;Attachable&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;Ingress&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;ConfigFrom&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Network&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;ConfigOnly&quot;</span><span class="token builtin class-name">:</span> false,
<span class="token string">&quot;Containers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
<span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
<span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token comment"># 我们来启动两个容器测试，使用自己的 mynet！</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat-net-01 --net mynet tomcat</span>
065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat-net-02 --net mynet tomcat</span>
2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID IMAGE PORTS NAMES
2e85d71afe87 tomcat <span class="token number">0</span> .0.0.0:32772-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp tomcat-net-02
065f82e947c7 tomcat <span class="token number">0</span> .0.0.0:32771-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp tomcat-net-01

<span class="token comment"># 再来查看下</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network inspect mynet</span>
<span class="token punctuation">[</span>
<span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mynet&quot;</span>,
<span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236&quot;</span>,
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token string">&quot;Containers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat-net-01&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;d61cef1bc294d7f10fb6d9b728735fc87bed79e4e02f5298374f0fab3e9b2da6&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:c0:a8:00:02&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.2/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat-net-02&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;adbc37a20526c2985c3589382998a3d106ef722662c7b296a57d8a7c8f449f38&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:c0:a8:00:03&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.3/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
<span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token comment"># 我们来测试ping容器名和ip试试，都可以ping通</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat-net-01 ping 192.168.0.3</span>
PING <span class="token number">192</span> .168.0.3 <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span> <span class="token number">56</span> <span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">192</span> .168.0.3: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .093 ms

<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat-net-01 ping tomcat-net-02</span>
PING tomcat-net-02 <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span> <span class="token number">56</span> <span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from tomcat-net-02.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span>
<span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .063 ms
<span class="token number">64</span> bytes from tomcat-net-02.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span>
<span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .066 ms

<span class="token comment"># 发现，我们自定义的网络docker都已经帮我们维护好了对应的关系</span>
<span class="token comment"># 所以我们平时都可以这样使用网络，不使用--link效果一样，所有东西实时维护好，直接域名 ping通。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br></div></div><h3 id="聊了这么多-我们现在应该可以深刻理解docker的网络了"><a href="#聊了这么多-我们现在应该可以深刻理解docker的网络了" class="header-anchor">#</a> 聊了这么多，我们现在应该可以深刻理解docker的网络了！</h3> <h2 id="网络连通"><a href="#网络连通" class="header-anchor">#</a> 网络连通</h2> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720105221.png" alt="img"></p> <blockquote><p>docker0和自定义网络肯定不通，我们使用自定义网络的好处就是网络隔离：<br><br>
大家公司项目部署的业务都非常多，假设我们有一个商城，我们会有订单业务（操作不同数据），会有<br>
订单业务购物车业务（操作不同缓存）。如果在一个网络下，有的程序猿的恶意代码就不能防止了，所<br>
以我们就在部署的时候网络隔离，创建两个桥接网卡，比如订单业务（里面的数据库，redis，mq，全<br>
部业务 都在order-net网络下）其他业务在其他网络。<br>
那关键的问题来了，如何让 tomcat-net-01 访问 tomcat1？<br></p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 启动默认的容器，在docker0网络下</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat01 tomcat</span>
bcd122e0dcf6bf8c861eaa934911f98a5497a4954f3fde9575e496160bd23287
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat02 tomcat</span>
6183aaeca003a3e5a3549a37f9c1040551320ae358807b4aaad547a986afb887
<span class="token comment">#### # 查看当前的容器</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID IMAGE PORTS NAMES
6183aaeca003 tomcat <span class="token number">0</span> .0.0.0:32774-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp tomcat02
bcd122e0dcf6 tomcat <span class="token number">0</span> .0.0.0:32773-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp tomcat01
2e85d71afe87 tomcat <span class="token number">0</span> .0.0.0:32772-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp tomcat-
net-02
065f82e947c7 tomcat <span class="token number">0</span> .0.0.0:32771-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp tomcat-
net-01

<span class="token comment"># 我们来查看下network帮助，发现一个命令 connect</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network --help</span>
Commands:
connect Connect a container to a network  <span class="token comment"># 连接一个容器到一个网络</span>
create Create a network
disconnect Disconnect a container from a network
inspect Display detailed information on one or <span class="token function">more</span> networks
<span class="token function">ls</span> List networks
prune Remove all unused networks
<span class="token function">rm</span> Remove one or <span class="token function">more</span> networks

<span class="token comment"># 我们来测试一下！打通mynet-docker0</span>
<span class="token comment"># 命令 docker network connect [OPTIONS] NETWORK CONTAINER</span>

<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network connect mynet tomcat01</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker network inspect mynet</span>
<span class="token punctuation">[</span>
<span class="token punctuation">{</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token string">&quot;Containers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat-net-01&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;d61cef1bc294d7f10fb6d9b728735fc87bed79e4e02f5298374f0fab3e9b2da6&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:c0:a8:00:02&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.2/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
<span class="token string">&quot;2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat-net-02&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;adbc37a20526c2985c3589382998a3d106ef722662c7b296a57d8a7c8f449f38&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:c0:a8:00:03&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.3/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>,
// 发现我们的tomcat01就进来这里了，tomcat01拥有了双ip
<span class="token string">&quot;bcd122e0dcf6bf8c861eaa934911f98a5497a4954f3fde9575e496160bd23287&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat01&quot;</span>,
<span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span>
<span class="token string">&quot;b2bf2342948e17048d872a4d5603c77e90d0e032439d510e86c10a1acc3928d9&quot;</span>,
<span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:c0:a8:00:04&quot;</span>,
<span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.4/16&quot;</span>,
<span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
   <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>,

 <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token comment"># tomcat01 可以ping通了</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ping tomcat-net-01</span>
PING tomcat-net-01 <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span> <span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from tomcat-net-01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span>
<span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .071 ms
<span class="token number">64</span> bytes from tomcat-net-01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span> <span class="token number">64</span>
<span class="token assign-left variable">time</span><span class="token operator">=</span> <span class="token number">0</span> .067 ms
<span class="token comment"># tomcat02 依旧ping不通，大家应该就理解了</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping tomcat-net-01</span>
ping: tomcat-net-01: Name or <span class="token function">service</span> not known
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><h3 id="结论-如果要跨网络操作别人-就需要使用-docker-network-connect-options-network-container-连接"><a href="#结论-如果要跨网络操作别人-就需要使用-docker-network-connect-options-network-container-连接" class="header-anchor">#</a> 结论：如果要跨网络操作别人，就需要使用 docker network connect [OPTIONS] NETWORK CONTAINER 连接</h3> <h2 id="实战-部署一个redis集群"><a href="#实战-部署一个redis集群" class="header-anchor">#</a> 实战：部署一个Redis集群</h2> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720105609.png" alt="img"></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 创建网卡</span>
<span class="token function">docker</span> network create redis <span class="token parameter variable">--subnet</span> <span class="token number">172</span> .38.0.0/16

<span class="token comment"># 通过脚本创建六个redis配置</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">6</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token punctuation">\</span>
<span class="token keyword">do</span> <span class="token punctuation">\</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf
<span class="token function">touch</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span>/mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf</span>
port 6379
bind 0 .0.0.0
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 172 .38.0.1<span class="token variable">${port}</span>
cluster-announce-port 6379
cluster-announce-bus-port 16379
appendonly yes
EOF</span>
<span class="token keyword">done</span>

<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">637</span> <span class="token variable">${port}</span>:6379 <span class="token parameter variable">-p</span> <span class="token number">1637</span> <span class="token variable">${port}</span>:16379 <span class="token parameter variable">--name</span> redis-<span class="token variable">${port}</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-<span class="token variable">${port}</span>/data:/data <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> redis <span class="token parameter variable">--ip</span> <span class="token number">172</span> .38.0.1<span class="token variable">${port}</span> redis:5.0.9-alpine3.11 redis-server/etc/redis/redis.conf<span class="token punctuation">;</span> <span class="token punctuation">\</span>

<span class="token comment"># 启动 6 个容器</span>
<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">6371</span> :6379 <span class="token parameter variable">-p</span> <span class="token number">16371</span> :16379 <span class="token parameter variable">--name</span> redis-1 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-1/data:/data <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> redis <span class="token parameter variable">--ip</span> <span class="token number">172</span> .38.0.11 redis:5.0.9-alpine3.11 redis-server/etc/redis/redis.conf

<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">6376</span> :6379 <span class="token parameter variable">-p</span> <span class="token number">16376</span> :16379 <span class="token parameter variable">--name</span> redis-6 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-6/data:/data <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> redis <span class="token parameter variable">--ip</span> <span class="token number">172</span> .38.0.16 redis:5.0.9-alpine3.11 redis-server/etc/redis/redis.conf

<span class="token comment"># 进入一个redis，注意这里是 sh命令</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> redis-1 /bin/sh

<span class="token comment"># 创建集群</span>
redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">172.38</span>.0.11:6379 <span class="token number">172.38</span>.0.12:6379 <span class="token number">172.38</span>.0.13:6379 <span class="token number">172.38</span>.0.14:6379 <span class="token number">172.38</span>.0.15:6379 <span class="token number">172.38</span>.0.16:6379 --cluster-replicas <span class="token number">1</span>

<span class="token comment"># 连接集群</span>
redis-cli <span class="token parameter variable">-c</span>

<span class="token comment"># 查看集群信息</span>
cluster info

<span class="token comment"># 查看节点</span>
cluster nodes

<span class="token comment"># set a b</span>
<span class="token comment"># 停止到存值的容器</span>
<span class="token comment"># 然后再次get a，发现依旧可以获取值</span>
<span class="token comment"># 查看节点，发现高可用完全没问题</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h1 id="idea整合docker"><a href="#idea整合docker" class="header-anchor">#</a> IDEA整合Docker</h1> <h2 id="创建项目"><a href="#创建项目" class="header-anchor">#</a> 创建项目</h2> <ul><li>1、使用 IDEA 构建一个 SpringBoot 项目</li> <li>2、编写一个helloController</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&quot;hello,kuangshen&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_3-、启动测试下-端口修改下-避免-8080-冲突-本地访问没问题就可以"><a href="#_3-、启动测试下-端口修改下-避免-8080-冲突-本地访问没问题就可以" class="header-anchor">#</a> 3 、启动测试下，端口修改下，避免 8080 冲突！本地访问没问题就可以！</h3> <h3 id="_4-、打jar包"><a href="#_4-、打jar包" class="header-anchor">#</a> 4 、打jar包</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720110400.png" alt="img"></p> <h5 id="有了-jar-包-我们就可以作镜像了-记得测试一下jar包可以使用吗"><a href="#有了-jar-包-我们就可以作镜像了-记得测试一下jar包可以使用吗" class="header-anchor">#</a> 有了 jar 包，我们就可以作镜像了！ 记得测试一下jar包可以使用吗！</h5> <h2 id="打包镜像"><a href="#打包镜像" class="header-anchor">#</a> 打包镜像</h2> <h5 id="_1-、在项目下编写-dockerfile-文件-将打包好的jar包拷贝到dockerfile同级目录"><a href="#_1-、在项目下编写-dockerfile-文件-将打包好的jar包拷贝到dockerfile同级目录" class="header-anchor">#</a> 1 、在项目下编写 Dockerfile 文件，将打包好的jar包拷贝到Dockerfile同级目录</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>FROM java:8

<span class="token comment"># 服务器只有dockerfile和jar在同级目录</span>
COPY *.jar /app.jar

CMD <span class="token punctuation">[</span><span class="token string">&quot;--server.port=8080&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># 指定容器内要暴露的端口</span>
EXPOSE <span class="token number">8080</span>

ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span>,<span class="token string">&quot;-jar&quot;</span>,<span class="token string">&quot;/app.jar&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="_2-、将dockerfile-和-项目的-jar-包上传到linux服务器上-构建运行"><a href="#_2-、将dockerfile-和-项目的-jar-包上传到linux服务器上-构建运行" class="header-anchor">#</a> 2 、将Dockerfile 和 项目的 jar 包上传到linux服务器上，构建运行</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@kuangshen idea<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/home/idea
<span class="token punctuation">[</span>root@kuangshen idea<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">17228</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">17634294</span> May <span class="token number">14</span> <span class="token number">12</span> :33 demo-0.0.1-SNAPSHOT.jar
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">207</span> May <span class="token number">14</span> <span class="token number">12</span> :32 Dockerfile

<span class="token comment"># 构建镜像</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> idea-ks.

<span class="token comment"># 查看镜像</span>
<span class="token function">docker</span> images

<span class="token comment"># 运行</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> idea-ks idea-ks

<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID IMAGE PORTS NAMES
2366c960ba99 idea-ks <span class="token number">0</span> .0.0.0:32779-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp idea-ks1

<span class="token comment"># 测试访问</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># curl localhost:32779</span>
<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># curl localhost:32779/hello</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="idea安装插件"><a href="#idea安装插件" class="header-anchor">#</a> IDEA安装插件</h2> <h6 id="了解即可-以后ci-cd-就完全没必要这样做"><a href="#了解即可-以后ci-cd-就完全没必要这样做" class="header-anchor">#</a> 了解即可！以后CI/CD，就完全没必要这样做！</h6> <h3 id="_1-、idea安装插件"><a href="#_1-、idea安装插件" class="header-anchor">#</a> 1 、IDEA安装插件</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720110711.png" alt="img"></p> <h3 id="_2-、配置docker连接集成"><a href="#_2-、配置docker连接集成" class="header-anchor">#</a> 2 、配置docker连接集成</h3> <p><img src="https://s-dehua.github.io/assets/images/QQ%E6%88%AA%E5%9B%BE20210720110736.png" alt="img"></p> <h3 id="_3-、集成了docker插件就可以在idea中操作docker内部的容器和镜像了-但是很鸡肋这个功能-对于我们开发人员来说"><a href="#_3-、集成了docker插件就可以在idea中操作docker内部的容器和镜像了-但是很鸡肋这个功能-对于我们开发人员来说" class="header-anchor">#</a> 3 、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说！</h3> <h3 id="之后学习的ci-cd才是真正在企业中的王道"><a href="#之后学习的ci-cd才是真正在企业中的王道" class="header-anchor">#</a> 之后学习的CI/CD才是真正在企业中的王道！</h3></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/s-dehua/s-dehua.github.io/edit/master/docs/02.后端/001.Docker学习/002.docker.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/11/24, 17:13:19</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/e80c8e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Docker部署hadoop集群(基于centos7)</div></a> <a href="/pages/3108f8/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">advanced</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/e80c8e/" class="prev">Docker部署hadoop集群(基于centos7)</a></span> <span class="next"><a href="/pages/3108f8/">advanced</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/3108f8/"><div>
            advanced
            <!----></div></a> <span class="date">11-24</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/bc4906/"><div>
            dockerfile
            <!----></div></a> <span class="date">11-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/54ba5f/"><div>
            docker 私有仓库
            <!----></div></a> <span class="date">11-24</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:sdhstart@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/s-dehua" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>帅德华 | <a href="https://github.com/s-dehua/s-dehua.github.io" target="_blank">学习空间</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.b7d292fb.js" defer></script><script src="/assets/js/2.cd5090ec.js" defer></script><script src="/assets/js/179.70c9f38b.js" defer></script>
  </body>
</html>
